<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="css/feed.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:media="http://search.yahoo.com/mrss/" xmlns:og="http://ogp.me/ns#">
<channel>
<atom:link rel="self" href="http://192.168.1.4/fivefilters/makefulltextfeed.php?url=feed.cnblogs.com%2Fblog%2Fsitehome%2Frss&amp;max=10&amp;links=preserve&amp;exc=" />
<atom:link rel="alternate" title="Source URL" href="http://feed.cnblogs.com/blog/sitehome/rss" />
<atom:link rel="related" title="Subscribe to feed" href="http://www.subtome.com/#/subscribe?feeds=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dfeed.cnblogs.com%252Fblog%252Fsitehome%252Frss%26max%3D10%26links%3Dpreserve%26exc%3D&amp;back=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dfeed.cnblogs.com%252Fblog%252Fsitehome%252Frss%26max%3D10%26links%3Dpreserve%26exc%3D" />
<title>博客园_首页</title>
<link></link>
<description>代码改变世界</description>
<item>
<title>读Zepto源码之fx_methods模块 - 对角另一面</title>
<link>http://www.cnblogs.com/hefty/p/7654370.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/hefty/p/7654370.html</guid>
<description>&lt;p&gt;&lt;code&gt;fx&lt;/code&gt; 模块提供了 &lt;code&gt;animate&lt;/code&gt; 动画方法，&lt;code&gt;fx_methods&lt;/code&gt; 利用 &lt;code&gt;animate&lt;/code&gt; 方法，提供一些常用的动画方法。所以 &lt;code&gt;fx_methods&lt;/code&gt; 模块依赖于 &lt;code&gt;fx&lt;/code&gt; 模块，在引入 &lt;code&gt;fx_methods&lt;/code&gt; 前必须引入 &lt;code&gt;fx&lt;/code&gt; 模块。&lt;/p&gt;
&lt;p&gt;读 Zepto 源码系列文章已经放到了github上，欢迎star: &lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto&quot;&gt;reading-zepto&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;源码版本&quot;&gt;源码版本&lt;/h2&gt;
&lt;p&gt;本文阅读的源码为 &lt;a href=&quot;https://github.com/madrobby/zepto/tree/v1.2.0&quot;&gt;zepto1.2.0&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;gitbook&quot;&gt;GitBook&lt;/h2&gt;
&lt;p&gt;《&lt;a href=&quot;https://yeyuqiudeng.gitbooks.io/reading-zepto/content/&quot;&gt;reading-zepto&lt;/a&gt;》&lt;/p&gt;
&lt;h2 id=&quot;内部方法&quot;&gt;内部方法&lt;/h2&gt;
&lt;h3 id=&quot;anim&quot;&gt;anim&lt;/h3&gt;
&lt;div class=&quot;sourceCode&quot; readability=&quot;19&quot;&gt;
&lt;pre class=&quot;sourceCode javascript&quot;&gt;
&lt;code class=&quot;sourceCode javascript&quot;&gt;&lt;span class=&quot;kw&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;anim&lt;/span&gt;(el&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; speed&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; opacity&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; scale&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; callback) &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;kw&quot;&gt;typeof&lt;/span&gt; speed &lt;span class=&quot;op&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;'function'&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;!&lt;/span&gt;callback) callback &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; speed&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; speed &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;undefined&lt;/span&gt;
  &lt;span class=&quot;kw&quot;&gt;var&lt;/span&gt; props &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;opacity&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;:&lt;/span&gt; opacity &lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; (scale) &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;va&quot;&gt;props&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;scale&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; scale
    &lt;span class=&quot;va&quot;&gt;el&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;css&lt;/span&gt;(&lt;span class=&quot;va&quot;&gt;$&lt;/span&gt;.&lt;span class=&quot;va&quot;&gt;fx&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;cssPrefix&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;'transform-origin'&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;'0 0'&lt;/span&gt;)
  &lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;el&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;animate&lt;/span&gt;(props&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; speed&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; callback)
&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;如果 &lt;code&gt;speed&lt;/code&gt; 的参数类型为函数，并且 &lt;code&gt;callback&lt;/code&gt; 没有传递，则认为 &lt;code&gt;speed&lt;/code&gt; 位置的参数为 &lt;code&gt;callback&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;props&lt;/code&gt; 是过渡的属性， &lt;code&gt;fx_fethods&lt;/code&gt; 主要实现 &lt;code&gt;show&lt;/code&gt; 、 &lt;code&gt;hide&lt;/code&gt; 和 &lt;code&gt;fadeIn&lt;/code&gt;、 &lt;code&gt;fadeOut&lt;/code&gt; 等动画，用到的过渡属性为 &lt;code&gt;opecity&lt;/code&gt; 和 &lt;code&gt;scale&lt;/code&gt; 。&lt;/p&gt;
&lt;p&gt;当为 &lt;code&gt;scale&lt;/code&gt; 时，将转换的原点设置为 &lt;code&gt;0 0&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;最后调用的是 &lt;code&gt;fx&lt;/code&gt; 模块中的 &lt;code&gt;animate&lt;/code&gt; 方法。&lt;/p&gt;
&lt;h3 id=&quot;hide&quot;&gt;hide&lt;/h3&gt;
&lt;div class=&quot;sourceCode&quot; readability=&quot;20&quot;&gt;
&lt;pre class=&quot;sourceCode javascript&quot;&gt;
&lt;code class=&quot;sourceCode javascript&quot;&gt;&lt;span class=&quot;kw&quot;&gt;var&lt;/span&gt; document &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;window&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; docElem &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;documentElement&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt;
    origShow &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;$&lt;/span&gt;.&lt;span class=&quot;va&quot;&gt;fn&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; origHide &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;$&lt;/span&gt;.&lt;span class=&quot;va&quot;&gt;fn&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;hide&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; origToggle &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;$&lt;/span&gt;.&lt;span class=&quot;va&quot;&gt;fn&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;toggle&lt;/span&gt;
&lt;span class=&quot;kw&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;hide&lt;/span&gt;(el&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; speed&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; scale&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; callback) &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;anim&lt;/span&gt;(el&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; speed&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; scale&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;function&lt;/span&gt;()&lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;va&quot;&gt;origHide&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;at&quot;&gt;$&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;this&lt;/span&gt;))
    callback &lt;span class=&quot;op&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;callback&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;this&lt;/span&gt;)
  &lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;)
&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;hide&lt;/code&gt; 方法其实就是将 &lt;code&gt;opacity&lt;/code&gt; 的属性设置为 &lt;code&gt;0&lt;/code&gt; 。在动画完成后，调用 &lt;code&gt;origHide&lt;/code&gt; 方法，即原有的 &lt;code&gt;hide&lt;/code&gt; 方法，将元素的 &lt;code&gt;display&lt;/code&gt; 设置为 &lt;code&gt;none&lt;/code&gt;。原有的 &lt;code&gt;hide&lt;/code&gt; 方法分析见《&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/6fb60c6a6ca1cf4f6846c32883774b5ba0f7de45/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E6%A0%B7%E5%BC%8F%E6%93%8D%E4%BD%9C.md#hide&quot;&gt;读Zepto源码之样式操作&lt;/a&gt;》&lt;/p&gt;
&lt;h2 id=&quot;show&quot;&gt;.show()&lt;/h2&gt;
&lt;div class=&quot;sourceCode&quot; readability=&quot;15&quot;&gt;
&lt;pre class=&quot;sourceCode javascript&quot;&gt;
&lt;code class=&quot;sourceCode javascript&quot;&gt;&lt;span class=&quot;va&quot;&gt;$&lt;/span&gt;.&lt;span class=&quot;va&quot;&gt;fn&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;show&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;function&lt;/span&gt;(speed&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; callback) &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;va&quot;&gt;origShow&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;this&lt;/span&gt;)
  &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; (speed &lt;span class=&quot;op&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;undefined&lt;/span&gt;) speed &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;
  &lt;span class=&quot;cf&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;css&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;'opacity'&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;)
  &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;anim&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; speed&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;'1,1'&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; callback)
&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;show&lt;/code&gt; 方法首先调用原有的 &lt;code&gt;hide&lt;/code&gt; 方法，将元素显示出来，这是实现动画的基本条件。&lt;/p&gt;
&lt;p&gt;如果没有设置 &lt;code&gt;speed&lt;/code&gt;， 表示不需要动画，则过渡时间 &lt;code&gt;speed&lt;/code&gt; 设置为 &lt;code&gt;0&lt;/code&gt;。立即显示元素。&lt;/p&gt;
&lt;p&gt;否则，先将 &lt;code&gt;opactity&lt;/code&gt; 设置为 &lt;code&gt;0&lt;/code&gt;， 再调用 &lt;code&gt;anim&lt;/code&gt; 方法执行动画。&lt;code&gt;opacity&lt;/code&gt; 设置为 &lt;code&gt;0&lt;/code&gt; 也是执行动画的关键，从 &lt;code&gt;0&lt;/code&gt; 变为 &lt;code&gt;1&lt;/code&gt; 才有过渡的效果。&lt;/p&gt;
&lt;h2 id=&quot;hide-1&quot;&gt;.hide()&lt;/h2&gt;
&lt;div class=&quot;sourceCode&quot; readability=&quot;13&quot;&gt;
&lt;pre class=&quot;sourceCode javascript&quot;&gt;
&lt;code class=&quot;sourceCode javascript&quot;&gt;&lt;span class=&quot;va&quot;&gt;$&lt;/span&gt;.&lt;span class=&quot;va&quot;&gt;fn&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;hide&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;function&lt;/span&gt;(speed&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; callback) &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; (speed &lt;span class=&quot;op&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;undefined&lt;/span&gt;) &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;origHide&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;this&lt;/span&gt;)
  &lt;span class=&quot;cf&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;hide&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; speed&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;'0,0'&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; callback)
&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;如果 &lt;code&gt;speed&lt;/code&gt; 没有传递，简单调用原有的 &lt;code&gt;hide&lt;/code&gt; 方法即可，因为不需要过渡效果。&lt;/p&gt;
&lt;p&gt;否则调用内部方法 &lt;code&gt;hide&lt;/code&gt;。&lt;/p&gt;
&lt;h2 id=&quot;toggle&quot;&gt;.toggle()&lt;/h2&gt;
&lt;div class=&quot;sourceCode&quot; readability=&quot;12&quot;&gt;
&lt;pre class=&quot;sourceCode javascript&quot;&gt;
&lt;code class=&quot;sourceCode javascript&quot;&gt;&lt;span class=&quot;va&quot;&gt;$&lt;/span&gt;.&lt;span class=&quot;va&quot;&gt;fn&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;toggle&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;function&lt;/span&gt;(speed&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; callback) &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; (speed &lt;span class=&quot;op&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;undefined&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;typeof&lt;/span&gt; speed &lt;span class=&quot;op&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;'boolean'&lt;/span&gt;)
    &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;origToggle&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; speed)
  &lt;span class=&quot;cf&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;each&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;function&lt;/span&gt;()&lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kw&quot;&gt;var&lt;/span&gt; el &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;$&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;this&lt;/span&gt;)
    el[&lt;span class=&quot;va&quot;&gt;el&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;css&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;'display'&lt;/span&gt;) &lt;span class=&quot;op&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;'none'&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;'show'&lt;/span&gt; : &lt;span class=&quot;st&quot;&gt;'hide'&lt;/span&gt;](speed&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; callback)
  &lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;)
&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;toggle&lt;/code&gt; 方法是 &lt;code&gt;show&lt;/code&gt; 和 &lt;code&gt;hide&lt;/code&gt; 方法的切换。&lt;/p&gt;
&lt;p&gt;如果 &lt;code&gt;speed&lt;/code&gt; 没有传递，或者为 &lt;code&gt;boolean&lt;/code&gt; 值，则表示不需要动画，调用原有的 &lt;code&gt;toggle&lt;/code&gt; 方法即可。为什么要有一个 &lt;code&gt;boolean&lt;/code&gt; 值的判断呢，这要看回 《&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/6fb60c6a6ca1cf4f6846c32883774b5ba0f7de45/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E6%A0%B7%E5%BC%8F%E6%93%8D%E4%BD%9C.md#toggle&quot;&gt;读Zepto源码之样式操作&lt;/a&gt;》关于 &lt;code&gt;toggle&lt;/code&gt; 方法的分析了，原有的 &lt;code&gt;toggle&lt;/code&gt; 方法接收一个参数，如果为 &lt;code&gt;true&lt;/code&gt;，则指定调用 &lt;code&gt;show&lt;/code&gt; 方法，否则调用 &lt;code&gt;hide&lt;/code&gt; 方法。&lt;/p&gt;
&lt;p&gt;否则，判断每个元素的 &lt;code&gt;display&lt;/code&gt; 属性值，如果为 &lt;code&gt;none&lt;/code&gt;，则调用 &lt;code&gt;show&lt;/code&gt; 方法显示，否则调用 &lt;code&gt;hide&lt;/code&gt; 方法隐藏。&lt;/p&gt;
&lt;h2 id=&quot;fadeto&quot;&gt;.fadeTo()&lt;/h2&gt;
&lt;div class=&quot;sourceCode&quot; readability=&quot;14&quot;&gt;
&lt;pre class=&quot;sourceCode javascript&quot;&gt;
&lt;code class=&quot;sourceCode javascript&quot;&gt;&lt;span class=&quot;va&quot;&gt;$&lt;/span&gt;.&lt;span class=&quot;va&quot;&gt;fn&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;fadeTo&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;function&lt;/span&gt;(speed&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; opacity&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; callback) &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;anim&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; speed&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; opacity&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; callback)
&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;fadeTo&lt;/code&gt; 可以其实是通过调节过渡时间 &lt;code&gt;speed&lt;/code&gt; 和透明度 &lt;code&gt;opacity&lt;/code&gt; 来实现动画效果。&lt;/p&gt;
&lt;p&gt;和 &lt;code&gt;show&lt;/code&gt; 和 &lt;code&gt;hide&lt;/code&gt; 不同的是，&lt;code&gt;fadeTo&lt;/code&gt; 的 &lt;code&gt;opacity&lt;/code&gt; 不一定为 &lt;code&gt;1&lt;/code&gt; 或者 &lt;code&gt;0&lt;/code&gt;， 可以由调用者指定。&lt;/p&gt;
&lt;h2 id=&quot;fadein&quot;&gt;.fadeIn()&lt;/h2&gt;
&lt;div class=&quot;sourceCode&quot; readability=&quot;12&quot;&gt;
&lt;pre class=&quot;sourceCode javascript&quot;&gt;
&lt;code class=&quot;sourceCode javascript&quot;&gt;&lt;span class=&quot;va&quot;&gt;$&lt;/span&gt;.&lt;span class=&quot;va&quot;&gt;fn&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;fadeIn&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;function&lt;/span&gt;(speed&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; callback) &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kw&quot;&gt;var&lt;/span&gt; target &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;css&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;'opacity'&lt;/span&gt;)
  &lt;span class=&quot;cf&quot;&gt;if&lt;/span&gt; (target &lt;span class=&quot;op&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;kw&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;css&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;'opacity'&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;)
  &lt;span class=&quot;cf&quot;&gt;else&lt;/span&gt; target &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;
  &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;origShow&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;this&lt;/span&gt;).&lt;span class=&quot;at&quot;&gt;fadeTo&lt;/span&gt;(speed&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; target&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; callback)
&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;淡入效果。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;fadeIn&lt;/code&gt; 其实调用的是 &lt;code&gt;fadeTo&lt;/code&gt; ，跟 &lt;code&gt;show&lt;/code&gt; 有点类似，最终将 &lt;code&gt;opacity&lt;/code&gt; 变为 &lt;code&gt;1&lt;/code&gt; 。只是不处理 &lt;code&gt;scale&lt;/code&gt; 变形。&lt;/p&gt;
&lt;h2 id=&quot;fadeout&quot;&gt;.fadeOut()&lt;/h2&gt;
&lt;div class=&quot;sourceCode&quot; readability=&quot;11&quot;&gt;
&lt;pre class=&quot;sourceCode javascript&quot;&gt;
&lt;code class=&quot;sourceCode javascript&quot;&gt;&lt;span class=&quot;va&quot;&gt;$&lt;/span&gt;.&lt;span class=&quot;va&quot;&gt;fn&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;fadeOut&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;function&lt;/span&gt;(speed&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; callback) &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;hide&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; speed&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; callback)
&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;淡出。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;fadeOut&lt;/code&gt; 调用的是 &lt;code&gt;hide&lt;/code&gt; 方法，只是不处理 &lt;code&gt;scale&lt;/code&gt; 变形。&lt;/p&gt;
&lt;h2 id=&quot;fadetoggle&quot;&gt;.fadeToggle()&lt;/h2&gt;
&lt;div class=&quot;sourceCode&quot; readability=&quot;10&quot;&gt;
&lt;pre class=&quot;sourceCode javascript&quot;&gt;
&lt;code class=&quot;sourceCode javascript&quot;&gt;&lt;span class=&quot;va&quot;&gt;$&lt;/span&gt;.&lt;span class=&quot;va&quot;&gt;fn&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;fadeToggle&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;function&lt;/span&gt;(speed&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; callback) &lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kw&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;each&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;function&lt;/span&gt;()&lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kw&quot;&gt;var&lt;/span&gt; el &lt;span class=&quot;op&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;at&quot;&gt;$&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;this&lt;/span&gt;)
    el[
      (&lt;span class=&quot;va&quot;&gt;el&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;css&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;'opacity'&lt;/span&gt;) &lt;span class=&quot;op&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;op&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;va&quot;&gt;el&lt;/span&gt;.&lt;span class=&quot;at&quot;&gt;css&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;'display'&lt;/span&gt;) &lt;span class=&quot;op&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;'none'&lt;/span&gt;) &lt;span class=&quot;op&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;st&quot;&gt;'fadeIn'&lt;/span&gt; : &lt;span class=&quot;st&quot;&gt;'fadeOut'&lt;/span&gt;
    ](speed&lt;span class=&quot;op&quot;&gt;,&lt;/span&gt; callback)
  &lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;)
&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;切换淡入淡出效果。&lt;/p&gt;
&lt;p&gt;如果 &lt;code&gt;display&lt;/code&gt; 为 &lt;code&gt;node&lt;/code&gt; 时，调用 &lt;code&gt;fadeIn&lt;/code&gt; 方法显示，否则调用 &lt;code&gt;fadeOut&lt;/code&gt; 方法隐藏。&lt;/p&gt;
&lt;h2 id=&quot;系列文章&quot;&gt;系列文章&lt;/h2&gt;
&lt;ol&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E4%BB%A3%E7%A0%81%E7%BB%93%E6%9E%84.md&quot;&gt;读Zepto源码之代码结构&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E5%86%85%E9%83%A8%E6%96%B9%E6%B3%95.md&quot;&gt;读Zepto源码之内部方法&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0.md&quot;&gt;读Zepto源码之工具函数&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E7%A5%9E%E5%A5%87%E7%9A%84%24.md&quot;&gt;读Zepto源码之神奇的$&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C.md&quot;&gt;读Zepto源码之集合操作&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E9%9B%86%E5%90%88%E5%85%83%E7%B4%A0%E6%9F%A5%E6%89%BE.md&quot;&gt;读Zepto源码之集合元素查找&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E6%93%8D%E4%BD%9CDOM.md&quot;&gt;读Zepto源码之操作DOM&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E6%A0%B7%E5%BC%8F%E6%93%8D%E4%BD%9C.md&quot;&gt;读Zepto源码之样式操作&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8B%E5%B1%9E%E6%80%A7%E6%93%8D%E4%BD%9C.md&quot;&gt;读Zepto源码之属性操作&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8BEvent%E6%A8%A1%E5%9D%97.md&quot;&gt;读Zepto源码之Event模块&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8BIE%E6%A8%A1%E5%9D%97.md&quot;&gt;读Zepto源码之IE模块&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8BCallbacks%E6%A8%A1%E5%9D%97.md&quot;&gt;读Zepto源码之Callbacks模块&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8BDeferred%E6%A8%A1%E5%9D%97.md&quot;&gt;读Zepto源码之Deferred模块&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8BAjax%E6%A8%A1%E5%9D%97.md&quot;&gt;读Zepto源码之Ajax模块&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8Bassets%E6%A8%A1%E5%9D%97.md&quot;&gt;读Zepto源码之Assets模块&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8BSelector%E6%A8%A1%E5%9D%97.md&quot;&gt;读Zepto源码之Selector模块&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8BTouch%E6%A8%A1%E5%9D%97.md&quot;&gt;读Zepto源码之Touch模块&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8BGesture%E6%A8%A1%E5%9D%97.md&quot;&gt;读Zepto源码之Gesture模块&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8BIOS3%E6%A8%A1%E5%9D%97.md&quot;&gt;读Zepto源码之IOS3模块&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/yeyuqiudeng/reading-zepto/blob/master/src/%E8%AF%BBZepto%E6%BA%90%E7%A0%81%E4%B9%8BFx%E6%A8%A1%E5%9D%97.md&quot;&gt;读Zepto源码之Fx模块&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;h2 id=&quot;参考&quot;&gt;参考&lt;/h2&gt;
&lt;h2 id=&quot;license&quot;&gt;License&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;http://creativecommons.org/licenses/by-nc-nd/4.0/&quot;&gt;署名-非商业性使用-禁止演绎 4.0 国际 (CC BY-NC-ND 4.0)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;作者：对角另一面&lt;/p&gt;
</description>
<pubDate>Wed, 11 Oct 2017 23:19:00 +0000</pubDate>
<dc:creator>对角另一面</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/hefty/p/7654370.html</dc:identifier>
</item>
<item>
<title>从头编写 asp.net core 2.0 web api 基础框架 (3) - solenovex</title>
<link>http://www.cnblogs.com/cgzl/p/7652413.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/cgzl/p/7652413.html</guid>
<description>&lt;p&gt;第一部分：&lt;a href=&quot;http://www.cnblogs.com/cgzl/p/7637250.html&quot; target=&quot;_blank&quot;&gt; http://www.cnblogs.com/cgzl/p/7637250.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;第二部分：&lt;a href=&quot;http://www.cnblogs.com/cgzl/p/7640077.html&quot; target=&quot;_blank&quot;&gt;http://www.cnblogs.com/cgzl/p/7640077.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Github源码地址：&lt;a href=&quot;https://github.com/solenovex/Building-asp.net-core-2-web-api-starter-template-from-scratch&quot; target=&quot;_blank&quot;&gt;https://github.com/solenovex/Building-asp.net-core-2-web-api-starter-template-from-scratch&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;之前我介绍完了asp.net core 2.0 web api最基本的CRUD操作，接下来继续研究：&lt;/p&gt;

&lt;p&gt;先举个例子说明一下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171011182922496-841051156.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;比如说我们的ProductController，需要使用Mylogger作为记录日志的服务，MyLogger是一个在设计时指定的具体的类，这就是说ProductController对MyLogger有一个依赖。MyLogger通常是在Constructor里面new出来的。假如ProductController还依赖于很多其他的Services，当有问题发生的时候，需要替换或修改MyLogger，那么ProductController的代码就需要更改了，这也违反了设计模式的原则（对修改关闭）。这样做呢，也不利于进行单元测试，单元测试的时候无法提供一个Mock（Mock就是在测试中对于某种不易构建的对象，建立的一个虚拟的版本，以方便测试）版本的MyLogger，因为我们使用的是具体的类。而ProductController同时也控制着MyLogger的生命周期，这是紧耦合。这个时候，&lt;strong&gt;Ioc（Inversion of control 控制反转）&lt;/strong&gt;就有用了！&lt;/p&gt;
&lt;p&gt;Ioc把&lt;strong&gt;为ProductController选择某个依赖项（具有Log功能的Service）的具体实现类（&lt;/strong&gt;MyLogger就是可能的具体实现类之一）的这项工作委托给了外部的一个组件。&lt;/p&gt;
&lt;p&gt;那么上面讲的Ioc的这项工作是怎么来实现的呢？那就是&lt;strong&gt;Depedency Injection&lt;/strong&gt;这个设计模式。&lt;/p&gt;
&lt;p&gt;Dependency Injection可以说是Ioc的一个特定的种类。&lt;/p&gt;
&lt;p&gt;DI模式是使用一个特定的对象（&lt;strong&gt;Container 容器&lt;/strong&gt;）来为目标类（ProductController）进行初始化并提供其所需要的依赖项（MyLogger）。Container管理者这些依赖项的生命周期。&lt;/p&gt;
&lt;p&gt;下面举一个典型的例子：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
    &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; ProductController : Controller
    {
        &lt;/span&gt;&lt;span&gt;private ILogger&amp;lt;ProductController&amp;gt; _logger; // interface 不是具体的实现类

        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; ProductController(&lt;span&gt;ILogger&amp;lt;ProductController&amp;gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt; logger&lt;/span&gt;)
        {
            _logger &lt;/span&gt;=&lt;span&gt; logger;
        }
    。。。。。
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ProductController里面需要有一个Field来保留这个依赖项，这里就是指_logger，而_logger不是具体的实现类，它是一个interface，ProductController需要的是一个实现了ILogger&amp;lt;T&amp;gt;接口的类。&lt;/p&gt;
&lt;p&gt;看一下Constructor的代码，这种叫做&lt;strong&gt;Constructor注入&lt;/strong&gt;。Constructor需要一个实现了ILogger&amp;lt;T&amp;gt;接口的类的实例，不是一个具体的类，还是一个interface。Container就会为ProductController注入它的依赖项。&lt;/p&gt;
&lt;p&gt;这样做的最终结果就是，&lt;strong&gt;松耦合&lt;/strong&gt;！（ProductController不必再为那些工作负责了，也和具体的实现类没有直接联系了）。这时，再需要替换和修改这些依赖项的时候仅需要改非常少的代码或者完全不用改代码了。而且单元测试也可以简单的进行了，因为这些依赖项（ILogger）都可以被实现了ILogger接口的Mock的版本来替代了。&lt;/p&gt;
&lt;p&gt;在asp.net core里面呢，&lt;strong&gt;Ioc和依赖注入是框架内置的&lt;/strong&gt;，这点和老版本的asp.net web api 2.2不一样，那时候我们得使用像autofac这样的第三方库来实现Ioc和依赖注入。&lt;/p&gt;
&lt;p&gt;在asp.net core里面有一些services是内置的并且已经在Container注册了，比如说记录日志用的Logger。其他的services也可以在container注册，这一般是在StartUp类里面的ConfigureServices方法来实现的，框架级以及应用级的services都可以加进来。&lt;/p&gt;
&lt;p&gt;下面我们就把内置的Logger服务注册进去。&lt;/p&gt;

&lt;p&gt;因为Logger是asp.net core 的内置service，所以我们就不需要在ConfigureService里面注册了。如果是asp.net core 1.0版本的话，我们需要配置一个或者多个Logger，但是asp.net core 2.0的话就不需要做这个工作了，因为在CreateDefaultBuilder方法里默认给配置了输出到Console和Debug窗口的Logger。这是源码：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36.5&quot;&gt;&lt;img id=&quot;code_img_closed_f28f64ca-4e19-42cb-a8d7-73ebe9b60ee6&quot; class=&quot;code_img_closed&quot; src=&quot;http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_f28f64ca-4e19-42cb-a8d7-73ebe9b60ee6&quot; class=&quot;code_img_opened&quot; src=&quot;http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_f28f64ca-4e19-42cb-a8d7-73ebe9b60ee6&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;68&quot;&gt;
&lt;pre&gt;
 &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; IWebHostBuilder CreateDefaultBuilder(&lt;span&gt;string&lt;/span&gt;&lt;span&gt;[] args)
        {
            &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; builder = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; WebHostBuilder()
                .UseKestrel()
                .UseContentRoot(Directory.GetCurrentDirectory())
                .ConfigureAppConfiguration((hostingContext, config) &lt;/span&gt;=&amp;gt;&lt;span&gt;
                {
                    &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; env =&lt;span&gt; hostingContext.HostingEnvironment;

                    config.AddJsonFile(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;appsettings.json&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;, optional: &lt;span&gt;true&lt;/span&gt;, reloadOnChange: &lt;span&gt;true&lt;/span&gt;&lt;span&gt;)
                          .AddJsonFile($&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;appsettings.{env.EnvironmentName}.json&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;, optional: &lt;span&gt;true&lt;/span&gt;, reloadOnChange: &lt;span&gt;true&lt;/span&gt;&lt;span&gt;);

                    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (env.IsDevelopment())
                    {
                        &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; appAssembly = Assembly.Load(&lt;span&gt;new&lt;/span&gt;&lt;span&gt; AssemblyName(env.ApplicationName));
                        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (appAssembly != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
                        {
                            config.AddUserSecrets(appAssembly, optional: &lt;/span&gt;&lt;span&gt;true&lt;/span&gt;&lt;span&gt;);
                        }
                    }

                    config.AddEnvironmentVariables();

                    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (args != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
                    {
                        config.AddCommandLine(args);
                    }
                })
                .ConfigureLogging((hostingContext, logging) &lt;/span&gt;=&amp;gt;&lt;span&gt;
                {
                    logging.AddConfiguration(hostingContext.Configuration.GetSection(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Logging&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;));
                    logging.AddConsole();
                    logging.AddDebug();
                })
                .UseIISIntegration()
                .UseDefaultServiceProvider((context, options) &lt;/span&gt;=&amp;gt;&lt;span&gt;
                {
                    options.ValidateScopes &lt;/span&gt;=&lt;span&gt; context.HostingEnvironment.IsDevelopment();
                });

            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (args != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
            {
                builder.UseConfiguration(&lt;/span&gt;&lt;span&gt;new&lt;/span&gt;&lt;span&gt; ConfigurationBuilder().AddCommandLine(args).Build());
            }

            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; builder;
        }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;

&lt;p&gt;我们可以在ProductController里面注入ILoggerFactory然后再创建具体的Logger。但是还有更好的方式，Container可以直接提供一个ILogger&amp;lt;T&amp;gt;的实例，这时候呢Logger就会使用T的名字作为日志的类别：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt;namespace&lt;/span&gt;&lt;span&gt; CoreBackend.Api.Controllers
{
    [Route(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;api/[controller]&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)]
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; ProductController : Controller
    {
        &lt;/span&gt;&lt;span&gt;private ILogger&amp;lt;ProductController&amp;gt; _logger;

        public ProductController(ILogger&amp;lt;ProductController&amp;gt; logger)
        {
            _logger =&lt;/span&gt;&lt;span&gt;&lt;span&gt; logger;
        }&lt;/span&gt;
......&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;如果通过Constructor注入的方式不可用，那么我们也可以直接从Container请求来得到它：HttpContext.RequestServices.GetService(typeof(ILogger&amp;lt;ProductController&amp;gt;)); 如果你在Constructor写这句话可能会空指针，因为这个时候HttpContext应该是null吧。&lt;/p&gt;
&lt;p&gt;不过还是&lt;strong&gt;建议使用Constructor注入的方式&lt;/strong&gt;！！！&lt;/p&gt;
&lt;p&gt;然后我们记录一些日志把：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
        [Route(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;{id}&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;, Name = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;GetProduct&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)]
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; IActionResult GetProduct(&lt;span&gt;int&lt;/span&gt;&lt;span&gt; id)
        {
            &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; product = ProductService.Current.Products.SingleOrDefault(x =&amp;gt; x.Id ==&lt;span&gt; id);
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (product == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
            {
                &lt;span&gt;_logger.LogInformation($&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&quot;Id为{id}的产品没有被找到..&quot;);
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; NotFound();
            }
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; Ok(product);
        }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Log记录时一般都分几个等级，这点我假设大家都知道吧，就不介绍了。&lt;/p&gt;
&lt;p&gt;然后试一下：通过Postman访问一个不存在的产品：‘/api/product/22’，然后看看Debug输出窗口：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171011193857340-2084263169.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;嗯，出现了，前边是分类，也就是ILogger&amp;lt;T&amp;gt;里面T的名字，然后是级别 Information，然后就是我们记录的Log内容。&lt;/p&gt;
&lt;p&gt;再Log一个Exception：&lt;/p&gt;
&lt;div class=&quot;cnblogs_Highlighter&quot; readability=&quot;38&quot;&gt;
&lt;pre class=&quot;brush:csharp;gutter:true;&quot;&gt;
        [Route(&quot;{id}&quot;, Name = &quot;GetProduct&quot;)]
        public IActionResult GetProduct(int id)
        {
            try
            {
                throw new Exception(&quot;来个异常！！！&quot;);
                var product = ProductService.Current.Products.SingleOrDefault(x =&amp;gt; x.Id == id);
                if (product == null)
                {
                    _logger.LogInformation($&quot;Id为{id}的产品没有被找到..&quot;);
                    return NotFound();
                }
                return Ok(product);
            }
            &lt;span&gt;catch (Exception ex)
            {
                _logger.LogCritical($&quot;查找Id为{id}的产品时出现了错误!!&quot;, ex);
                return StatusCode(500, &quot;处理请求的时候发生了错误！&quot;);
            }&lt;/span&gt;
        }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;　　记录Exception就建议使用LogCritical了，这里需要注意的是Exception的发生就表示服务器发生了错误，我们应该处理这个exception并返回500。使用StatusCode这个方法返回特定的StatusCode，然后可以加一个参数来解释这个错误（这里一般不建议返回exception的细节）。&lt;/p&gt;
&lt;p&gt;运行试试：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171011194719168-1699181090.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171011194749184-1345509688.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;OK。&lt;/p&gt;
&lt;p&gt;Log到Debug窗口或者Console窗口还是比较方便的，但是正式生产环境中这肯定不够用。&lt;/p&gt;
&lt;p&gt;正式环境应该Log到文件或者数据库。虽然asp.net core 的log内置了记录到Windows Event的方法，但是由于Windows Event是windows系统独有的，所以这个方法无法跨平台，也就不建议使用了。&lt;/p&gt;
&lt;p&gt;官方文档上列出了这几个建议使用的第三发Log Provider：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171011195120496-1851542208.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;把这几个Log provider注册到asp.net core的方式几乎是一摸一样的，所以介绍一个就行。我们就用比较火的NLog吧。&lt;/p&gt;

&lt;p&gt;首先通过nuget安装Nlog: &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171011195753574-1788792417.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;注意要勾上include prerelease，目前还不是正式版。&lt;/p&gt;
&lt;p&gt;装完之后，我们就需要为Nlog添加配置文件了。默认情况下Nlog会在根目录寻找一个叫做nlog.config的文件作为配置文件。那么我们就手动改添加一个nlog.config:&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&amp;gt;
&amp;lt;nlog xmlns=&quot;http://www.nlog-project.org/schemas/NLog.xsd&quot;
      xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&amp;gt;
  &amp;lt;targets&amp;gt;
    &amp;lt;target name=&quot;logfile&quot; xsi:type=&quot;File&quot; fileName=&quot;logs/${shortdate}.log&quot; /&amp;gt;

  &amp;lt;/targets&amp;gt;
  &amp;lt;rules&amp;gt;
    &amp;lt;logger name=&quot;*&quot; minlevel=&quot;Info&quot; writeTo=&quot;logfile&quot; /&amp;gt;
  &amp;lt;/rules&amp;gt;
&amp;lt;/nlog&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然后设置该文件的属性如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171011202826184-1056521197.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;对于Nlog的配置就不进行深入介绍了。具体请看&lt;a href=&quot;https://github.com/NLog/NLog.Extensions.Logging/blob/master/README.md#how-to-use&quot; target=&quot;_blank&quot;&gt;官方文档&lt;/a&gt;的.net core那部分。&lt;/p&gt;
&lt;p&gt;然后需要把Nlog集成到asp.net core，也就是把Nlog注册到ILoggerFactory里面。所以打开Startup.cs，首先注入ILoggerFactory，然后对ILoggerFactory进行配置，为其注册NLog的Provider：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
public void Configure(IApplicationBuilder app, IHostingEnvironment env&lt;span&gt;, ILoggerFactory loggerFactory&lt;/span&gt;)
        {
            // &lt;span&gt;loggerFactory.AddProvider(new NLogLoggerProvider());&lt;br/&gt;loggerFactory.AddNLog();&lt;/span&gt;

            if (env.IsDevelopment())
            {
                app.UseDeveloperExceptionPage();
            }
            else
            {
                app.UseExceptionHandler();
            }

            app.UseStatusCodePages();

            app.UseMvc();
        }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;针对LoggerFactory.AddProvider()这种写法，Nlog一个简单的ExtensionMethod做了这个工作，就是&lt;strong&gt;AddNlog();&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;添加完NLog，其余的代码都不需要改，然后我们试下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171011202703902-37760950.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;在如图所示的位置出现了log文件。内容如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171011202709840-1484411305.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;一个系统中可能需要很多个自定义的service，下面举一个简单的例子，&lt;/p&gt;
&lt;p&gt;建立LocalMailService.cs：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt;namespace&lt;/span&gt;&lt;span&gt; CoreBackend.Api.Services
{
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; LocalMailService
    {
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; _mailTo = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;developer@qq.com&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; _mailFrom = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;noreply@alibaba.com&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;

        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Send(&lt;span&gt;string&lt;/span&gt; subject, &lt;span&gt;string&lt;/span&gt;&lt;span&gt; msg)
        {
            Debug.WriteLine($&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;从{_mailFrom}给{_mailTo}通过{nameof(LocalMailService)}发送了邮件&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
        }
    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;使用这个Service，我们假装在删除Product的时候发送邮件。&lt;/p&gt;
&lt;p&gt;首先，我们要把这个LocalMailService注册给Container。打开Startup.cs进入ConfigureServices方法。这里面有三种方法可以注册service：&lt;span&gt;&lt;strong&gt;AddTransient，AddScoped和AddSingleton&lt;/strong&gt;&lt;/span&gt;，这些都表示service的生命周期。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;transient&lt;/strong&gt;的services是每次请求（不是指Http request）都会创建一个新的实例，它比较适合轻量级的无状态的（Stateless）的service。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;scope&lt;/strong&gt;的services是每次http请求会创建一个实例。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;singleton&lt;/strong&gt;的在第一次请求的时候就会创建一个实例，以后也只有这一个实例，或者在ConfigureServices这段代码运行的时候创建唯一一个实例。&lt;/p&gt;
&lt;p&gt;我们的LocalMailService比较适合Transient：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; ConfigureServices(IServiceCollection services)
        {
            services.AddMvc();
            &lt;span&gt;services.AddTransient&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&amp;lt;LocalMailService&amp;gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;();&lt;/span&gt;
        }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;现在呢，就可以注入LocalMailService的实例了：&lt;/p&gt;

&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt;namespace&lt;/span&gt;&lt;span&gt; CoreBackend.Api.Controllers
{
    [Route(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;api/[controller]&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)]
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; ProductController : Controller
    {
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; ILogger&amp;lt;ProductController&amp;gt;&lt;span&gt; _logger;
        &lt;/span&gt;&lt;span&gt;private readonly LocalMailService _localMailService;

        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; ProductController(
            ILogger&lt;/span&gt;&amp;lt;ProductController&amp;gt;&lt;span&gt; logger,
            &lt;span&gt;LocalMailService localMailService&lt;/span&gt;)
        {
            _logger &lt;/span&gt;=&lt;span&gt; logger;
            &lt;span&gt;_localMailService &lt;/span&gt;&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;&lt;span&gt; localMailService;&lt;/span&gt;
        }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
        [HttpDelete(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;{id}&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)]
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; IActionResult Delete(&lt;span&gt;int&lt;/span&gt;&lt;span&gt; id)
        {
            &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; model = ProductService.Current.Products.SingleOrDefault(x =&amp;gt; x.Id ==&lt;span&gt; id);
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (model == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
            {
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; NotFound();
            }
            ProductService.Current.Products.Remove(model);
            &lt;span&gt;_localMailService.Send(&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&quot;Product Deleted&quot;,$&quot;Id为{id}的产品被删除了&quot;);
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; NoContent();
        }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然后试一下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171011204700668-1039775169.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;嗯，没问题。&lt;/p&gt;
&lt;p&gt;但是现在的写法并不符合DI的意图。所以修改一下代码，首先添加一个interface，然后让LocalMailService去实现它：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
&lt;span&gt;namespace&lt;/span&gt;&lt;span&gt; CoreBackend.Api.Services
{
    &lt;/span&gt;&lt;span&gt;public interface IMailService
    {
        void Send(string subject, string msg);
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; LocalMailService&lt;span&gt;: IMailService&lt;/span&gt;
    {
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; _mailTo = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;developer@qq.com&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; _mailFrom = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;noreply@alibaba.com&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;

        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Send(&lt;span&gt;string&lt;/span&gt; subject, &lt;span&gt;string&lt;/span&gt;&lt;span&gt; msg)
        {
            Debug.WriteLine($&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;从{_mailFrom}给{_mailTo}通过{nameof(LocalMailService)}发送了邮件&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
        }
    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;有了IMailService这个interface，Container就可以为我们提供实现了IMailService接口的不同的类了。&lt;/p&gt;
&lt;p&gt;所以再建立一个CloudMailService：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
    &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; CloudMailService &lt;span&gt;: IMailService&lt;/span&gt;
    {
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; _mailTo = &lt;span&gt;&quot;admin@qq.com&quot;;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; _mailFrom = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;noreply@alibaba.com&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;

        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Send(&lt;span&gt;string&lt;/span&gt; subject, &lt;span&gt;string&lt;/span&gt;&lt;span&gt; msg)
        {
            Debug.WriteLine($&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;从{_mailFrom}给{_mailTo}通过{nameof(LocalMailService)}发送了邮件&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然后回到ConfigureServices方法里面：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; ConfigureServices(IServiceCollection services)
        {
            services.AddMvc();
            &lt;span&gt;services.AddTransient&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&amp;lt;IMailService, LocalMailService&amp;gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;();&lt;/span&gt;
        }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这句话的意思就是，当需要IMailService的一个实现的时候，Container就会提供一个LocalMailService的实例。&lt;/p&gt;
&lt;p&gt;然后改一下ProductController：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt;namespace&lt;/span&gt;&lt;span&gt; CoreBackend.Api.Controllers
{
    [Route(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;api/[controller]&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)]
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; ProductController : Controller
    {
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; ILogger&amp;lt;ProductController&amp;gt;&lt;span&gt; _logger;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt;&lt;span&gt;&lt;span&gt; IMailService&lt;/span&gt; _mailService;

        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; ProductController(
            ILogger&lt;/span&gt;&amp;lt;ProductController&amp;gt;&lt;span&gt; logger,
            &lt;span&gt;IMailService&lt;/span&gt; mailService)
        {
            _logger &lt;/span&gt;=&lt;span&gt; logger;
            _mailService &lt;/span&gt;=&lt;span&gt; mailService;
        }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然后运行一下，效果和上面是一样的。&lt;/p&gt;
&lt;p&gt;然而我们注册了LocalMailService，那么CloudMailService是什么时候用呢？&lt;/p&gt;
&lt;p&gt;分两种方式：&lt;/p&gt;
&lt;p&gt;一、使用&lt;strong&gt;&lt;span&gt;compiler directive&lt;/span&gt;&lt;/strong&gt;：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; ConfigureServices(IServiceCollection services)
        {
            services.AddMvc();
&lt;/span&gt;&lt;span&gt;#if DEBUG&lt;/span&gt;&lt;span&gt;
            services.AddTransient&lt;/span&gt;&amp;lt;IMailService, LocalMailService&amp;gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt;#else
            services.AddTransient&amp;lt;IMailService, CloudMailService&amp;gt;();
#endif&lt;/span&gt;&lt;span&gt;
        }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这样写就是告诉compiler，如果是Debug build的情况下，那么就使用LocalMailService（把这句话纳入编译的范围），如果是在Release Build的模式下，就是用CloudMailService。&lt;/p&gt;
&lt;p&gt;那我们就切换到Release Build模式（或者在DEBUG前边加一个叹号试试）：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171011210052277-1226819378.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171011210420980-979716351.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;运行试试，居然没起作用。随后发现原因是这样的：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171011210844152-1513690182.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;在Release模式下Debug.WriteLine将不会被调用，因为这是Debug Build模式下专有的方法。。。&lt;/p&gt;
&lt;p&gt;那我们就改一下Cloud'MailService，使用logger吧：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
 &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; CloudMailService : IMailService
    {
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; _mailTo = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;admin@qq.com&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; _mailFrom = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;noreply@alibaba.com&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
        &lt;/span&gt;&lt;span&gt;private readonly ILogger&amp;lt;CloudMailService&amp;gt; _logger;

        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; CloudMailService(&lt;span&gt;ILogger&amp;lt;CloudMailService&amp;gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt; logger&lt;/span&gt;)
        {
            &lt;span&gt;_logger &lt;/span&gt;&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;&lt;span&gt; logger;&lt;/span&gt;
        }

        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Send(&lt;span&gt;string&lt;/span&gt; subject, &lt;span&gt;string&lt;/span&gt;&lt;span&gt; msg)
        {
           &lt;span&gt; _logger.LogInformation&lt;/span&gt;($&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;从{_mailFrom}给{_mailTo}通过{nameof(LocalMailService)}发送了邮件&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然后再试一下看看结果：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171011211227418-34508810.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;这回就没问题了。&lt;/p&gt;
&lt;p&gt;二、&lt;strong&gt;是通过环境变量控制配置文件&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;asp.net core 支持各式各样的配置方法，包括使用JSON，xml， ini文件，环境变量，命令行参数等等。建议使用的还是JSON。&lt;/p&gt;
&lt;p&gt;创建一个appSettings.json文件，然后把MailService相关的常量存到里面：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt;{
  &lt;/span&gt;&quot;mailSettings&quot;&lt;span&gt;: {
    &lt;/span&gt;&quot;mailToAddress&quot;: &quot;admin__json@qq.com&quot;&lt;span&gt;,
    &lt;/span&gt;&quot;mailFromAddress&quot;: &quot;noreply__json@qq.com&quot;&lt;span&gt;
  }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;asp.net core 2.0 默认已经做了相关的配置，我们再看一下这&lt;a href=&quot;https://github.com/aspnet/MetaPackages/blob/dev/src/Microsoft.AspNetCore/WebHost.cs&quot; target=&quot;_blank&quot;&gt;部分的源码&lt;/a&gt;：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;40&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; IWebHostBuilder CreateDefaultBuilder(&lt;span&gt;string&lt;/span&gt;&lt;span&gt;[] args)
        {
            &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; builder = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; WebHostBuilder()
                .UseKestrel()
                .&lt;span&gt;UseContentRoot(Directory.GetCurrentDirectory())&lt;/span&gt;
                .ConfigureAppConfiguration((hostingContext, &lt;span&gt;config&lt;/span&gt;) &lt;/span&gt;=&amp;gt;&lt;span&gt;
                {
                    &lt;/span&gt;&lt;span&gt;var env = hostingContext.HostingEnvironment;

                    config.AddJsonFile(&quot;appsettings.json&quot;, optional: true, reloadOnChange: true)
                          .AddJsonFile($&quot;appsettings.{env.EnvironmentName}.json&quot;, optional: true, reloadOnChange: true);

               。。。。。。&lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; builder;
        }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;红色部分的config的类型是IConfigurationBuilder，它用来配置的。首先是要找到appSettings.json文件，asp.net core 2.0已经做好了相关配置，它默认会从ContentRoot去找appSettings.json文件。&lt;/p&gt;
&lt;p&gt;然后使用AddJsonFile这个方法来添加Json配置文件，第一个参数是文件名；第二个参数optional表示这个配置文件是否是可选的，把它设置成false表示我们不必非得用这个配置文件；第三个参数reloadOnChange为true，表示如果运行的时候配置文件变化了，那么就立即重载它。&lt;/p&gt;
&lt;p&gt;使用appSettings.json里面的值就需要使用实现了IConfiguration这个接口的对象。建议的做法是：在Startup.cs里面注入IConfiguration（这个时候通过CreateDefaultBuilder方法，它已经建立好了），然后把它赋给一个静态的property：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
    &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; Startup
    {
        &lt;/span&gt;&lt;span&gt;public static IConfiguration Configuration { get; private set; }

        public Startup(IConfiguration configuration)
        {
            Configuration = configuration;
        }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然后我们把LocalMailService里面改一下：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
    &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; LocalMailService: IMailService
    {
        &lt;/span&gt;&lt;span&gt;private readonly string _mailTo = Startup.Configuration[&quot;mailSettings:mailToAddress&quot;];
        private readonly string _mailFrom = Startup.Configuration[&quot;mailSettings:mailFromAddress&quot;];

        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Send(&lt;span&gt;string&lt;/span&gt; subject, &lt;span&gt;string&lt;/span&gt;&lt;span&gt; msg)
        {
            Debug.WriteLine($&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;从{_mailFrom}给{_mailTo}通过{nameof(LocalMailService)}发送了邮件&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;通过刚才写的Startup.Configuration来访问json配置文件中的变量，根据json文件中的层次结构，第一层对象我们取的是mailSettings，然后试mailToAddress和mailFromAddress，他们之间用冒号分开，表示它们的层次结构。&lt;/p&gt;
&lt;p&gt;通过这种方法取得到的值都是字符串。&lt;/p&gt;
&lt;p&gt;然后运行一下试试，别忘了把Build模式改成Debug：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171012064646574-279727537.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;嗯，没问题。&lt;/p&gt;

&lt;p&gt;针对不同的环境选择不同的JSON配置文件，要求这个文件的名字的一部分包含有环境的名称。&lt;/p&gt;
&lt;p&gt;添加一个Production环境下的配置文件：appSettings.Production.json， 其中Production是环境的名称，在项目--属性--Debug 里面环境变量的值：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171012065222871-115490840.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;建立好appSettings.Production.json后，可以发现它被作为appSettings.json的一个子文件显示出来，这样很好：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171012065440559-2110015975.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
{
  &quot;mailSettings&quot;: {
    &quot;mailToAddress&quot;: &quot;admin__Production@qq.com&quot;
  }
}
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;再看一下这部分的源码：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
config.AddJsonFile(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;appsettings.json&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;, optional: &lt;span&gt;true&lt;/span&gt;, reloadOnChange: &lt;span&gt;true&lt;/span&gt;&lt;span&gt;)
      .AddJsonFile(&lt;span&gt;$&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&quot;appsettings.{env.EnvironmentName}.json&quot;&lt;/span&gt;, optional: &lt;span&gt;true&lt;/span&gt;, reloadOnChange: &lt;span&gt;true&lt;/span&gt;);
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;AddJsonFile方法调用的顺序非常重要，&lt;/strong&gt;它决定了多个配置文件的优先级。这里如果某个变量在appSettings和appSettings.Production.json都有，那么appSettings.Production.json的变量会被采用，因为appSettings.Production.json文件是后来才被调用的。&lt;/p&gt;
&lt;p&gt;其中env的类型是IHostingEnvirongment，它里面的EnvironmentName就是环境变量的名称，如果环境变量填写的是Production，那就是appSettings.Production.json。&lt;/p&gt;
&lt;p&gt;这么写的作用就是如果是在Production环境下，那么appSettings.json里面的部分变量值就会被appSettings.Production.json里面也存在的变量的值覆盖。&lt;/p&gt;
&lt;p&gt;试试：首先环境变量是Development：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171012070801027-1610375613.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;然后改成Production，试试：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171012070843449-392492950.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/986268/201710/986268-20171012070953230-541573421.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;结果如预期。&lt;/p&gt;
&lt;p&gt;综上，通过Compiler Directive（设置Debug Build / Release Build），并结合着不同的环境变量和配置文件，asp.net core的配置是非常的灵活的。&lt;/p&gt;
</description>
<pubDate>Wed, 11 Oct 2017 23:16:00 +0000</pubDate>
<dc:creator>solenovex</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/cgzl/p/7652413.html</dc:identifier>
</item>
<item>
<title>YYHS-Super Big Stupid Cross（二分+扫描线+平衡树） - I__am</title>
<link>http://www.cnblogs.com/zhuchenrui/p/7654365.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/zhuchenrui/p/7654365.html</guid>
<description>&lt;pre&gt;
&lt;span&gt;  1&lt;/span&gt; #include&amp;lt;algorithm&amp;gt;
&lt;span&gt;  2&lt;/span&gt; #include&amp;lt;cstdio&amp;gt;
&lt;span&gt;  3&lt;/span&gt; #include&amp;lt;cstring&amp;gt;
&lt;span&gt;  4&lt;/span&gt; #include&amp;lt;&lt;span&gt;set&lt;/span&gt;&amp;gt;
&lt;span&gt;  5&lt;/span&gt; &lt;span&gt;#define&lt;/span&gt; N 100005
&lt;span&gt;  6&lt;/span&gt; &lt;span&gt;using&lt;/span&gt; &lt;span&gt;namespace&lt;/span&gt;&lt;span&gt; std;
&lt;/span&gt;&lt;span&gt;  7&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; n,x1,x2,y1,y2,cnt1,cnt2,l,r,ans,nums,numh;
&lt;/span&gt;&lt;span&gt;  8&lt;/span&gt; multiset&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; q;
&lt;/span&gt;&lt;span&gt;  9&lt;/span&gt; typedef &lt;span&gt;set&lt;/span&gt;&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt;::iterator It;
&lt;/span&gt;&lt;span&gt; 10&lt;/span&gt; &lt;span&gt;struct&lt;/span&gt;&lt;span&gt; node{
&lt;/span&gt;&lt;span&gt; 11&lt;/span&gt;     &lt;span&gt;int&lt;/span&gt;&lt;span&gt; x,l,r,len;
&lt;/span&gt;&lt;span&gt; 12&lt;/span&gt; &lt;span&gt;}s[N],ts[N];
&lt;/span&gt;&lt;span&gt; 13&lt;/span&gt; &lt;span&gt;struct&lt;/span&gt;&lt;span&gt; Node{
&lt;/span&gt;&lt;span&gt; 14&lt;/span&gt;     &lt;span&gt;int&lt;/span&gt;&lt;span&gt; y,l,r,len,id;
&lt;/span&gt;&lt;span&gt; 15&lt;/span&gt; &lt;span&gt;}h[N],th[N],Th[N];
&lt;/span&gt;&lt;span&gt; 16&lt;/span&gt; &lt;span&gt;struct&lt;/span&gt;&lt;span&gt; NODE{
&lt;/span&gt;&lt;span&gt; 17&lt;/span&gt;     &lt;span&gt;int&lt;/span&gt;&lt;span&gt; p,id;
&lt;/span&gt;&lt;span&gt; 18&lt;/span&gt; &lt;span&gt;}L[N],R[N];
&lt;/span&gt;&lt;span&gt; 19&lt;/span&gt; &lt;span&gt;bool&lt;/span&gt; cmp(node x,node y){ &lt;span&gt;return&lt;/span&gt; x.x&amp;lt;&lt;span&gt;y.x; }
&lt;/span&gt;&lt;span&gt; 20&lt;/span&gt; &lt;span&gt;bool&lt;/span&gt;&lt;span&gt; cmp1(Node x,Node y){
&lt;/span&gt;&lt;span&gt; 21&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (x.l!=y.l) &lt;span&gt;return&lt;/span&gt; x.l&amp;lt;&lt;span&gt;y.l;
&lt;/span&gt;&lt;span&gt; 22&lt;/span&gt;             &lt;span&gt;else&lt;/span&gt; &lt;span&gt;return&lt;/span&gt; x.r&amp;lt;&lt;span&gt;y.r;
&lt;/span&gt;&lt;span&gt; 23&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 24&lt;/span&gt; &lt;span&gt;bool&lt;/span&gt;&lt;span&gt; cmp2(Node x,Node y){
&lt;/span&gt;&lt;span&gt; 25&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (x.r!=y.r) &lt;span&gt;return&lt;/span&gt; x.r&amp;lt;&lt;span&gt;y.r;
&lt;/span&gt;&lt;span&gt; 26&lt;/span&gt;             &lt;span&gt;else&lt;/span&gt; &lt;span&gt;return&lt;/span&gt; x.l&amp;lt;&lt;span&gt;y.l;
&lt;/span&gt;&lt;span&gt; 27&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 28&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; pre(&lt;span&gt;int&lt;/span&gt;&lt;span&gt; len){
&lt;/span&gt;&lt;span&gt; 29&lt;/span&gt;     nums=numh=&lt;span&gt;0&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 30&lt;/span&gt;     &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i=&lt;span&gt;1&lt;/span&gt;;i&amp;lt;=cnt1;i++&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 31&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (s[i].len&amp;gt;=&lt;span&gt;2&lt;/span&gt;*&lt;span&gt;len){
&lt;/span&gt;&lt;span&gt; 32&lt;/span&gt;             ts[++nums].x=&lt;span&gt;s[i].x;
&lt;/span&gt;&lt;span&gt; 33&lt;/span&gt;             ts[nums].len=s[i].len-&lt;span&gt;2&lt;/span&gt;*&lt;span&gt;len;
&lt;/span&gt;&lt;span&gt; 34&lt;/span&gt;             ts[nums].l=s[i].l+len; ts[nums].r=s[i].r-&lt;span&gt;len;
&lt;/span&gt;&lt;span&gt; 35&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt; 36&lt;/span&gt;     &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i=&lt;span&gt;1&lt;/span&gt;;i&amp;lt;=cnt2;i++&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 37&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (h[i].len&amp;gt;=&lt;span&gt;2&lt;/span&gt;*&lt;span&gt;len){
&lt;/span&gt;&lt;span&gt; 38&lt;/span&gt;             th[++numh].y=&lt;span&gt;h[i].y;
&lt;/span&gt;&lt;span&gt; 39&lt;/span&gt;             th[numh].len=h[i].len-&lt;span&gt;2&lt;/span&gt;*&lt;span&gt;len;
&lt;/span&gt;&lt;span&gt; 40&lt;/span&gt;             th[numh].l=h[i].l+len; th[numh].r=h[i].r-&lt;span&gt;len;
&lt;/span&gt;&lt;span&gt; 41&lt;/span&gt;             th[numh].id=numh;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;加入的id值 &lt;/span&gt;
&lt;span&gt; 42&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt; 43&lt;/span&gt;     memcpy(Th,th,&lt;span&gt;sizeof&lt;/span&gt;(th));&lt;span&gt;//&lt;/span&gt;&lt;span&gt;用临时数组把th存下来，因为之后th数组会被排序 &lt;/span&gt;
&lt;span&gt; 44&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 45&lt;/span&gt; &lt;span&gt;bool&lt;/span&gt; check(&lt;span&gt;int&lt;/span&gt;&lt;span&gt; len){
&lt;/span&gt;&lt;span&gt; 46&lt;/span&gt; &lt;span&gt;    q.clear();
&lt;/span&gt;&lt;span&gt; 47&lt;/span&gt;     q.insert(1e9);&lt;span&gt;//&lt;/span&gt;&lt;span&gt;防止lower_bound找到0 &lt;/span&gt;
&lt;span&gt; 48&lt;/span&gt; &lt;span&gt;    pre(len);
&lt;/span&gt;&lt;span&gt; 49&lt;/span&gt;     sort(ts+&lt;span&gt;1&lt;/span&gt;,ts+&lt;span&gt;1&lt;/span&gt;+&lt;span&gt;nums,cmp);
&lt;/span&gt;&lt;span&gt; 50&lt;/span&gt;     sort(th+&lt;span&gt;1&lt;/span&gt;,th+&lt;span&gt;1&lt;/span&gt;+&lt;span&gt;numh,cmp1);
&lt;/span&gt;&lt;span&gt; 51&lt;/span&gt;     &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i=&lt;span&gt;1&lt;/span&gt;;i&amp;lt;=numh;i++&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 52&lt;/span&gt;         L[i].p=th[i].l,L[i].id=th[i].id;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;按左端点排序 &lt;/span&gt;
&lt;span&gt; 53&lt;/span&gt;     sort(th+&lt;span&gt;1&lt;/span&gt;,th+&lt;span&gt;1&lt;/span&gt;+&lt;span&gt;numh,cmp2);
&lt;/span&gt;&lt;span&gt; 54&lt;/span&gt;     &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i=&lt;span&gt;1&lt;/span&gt;;i&amp;lt;=numh;i++&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 55&lt;/span&gt;         R[i].p=th[i].r,R[i].id=th[i].id;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;按右端点排序 &lt;/span&gt;
&lt;span&gt; 56&lt;/span&gt;     L[numh+&lt;span&gt;1&lt;/span&gt;].p=R[numh+&lt;span&gt;1&lt;/span&gt;].p=ts[nums+&lt;span&gt;1&lt;/span&gt;].x=1e9;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;防止越界 &lt;/span&gt;
&lt;span&gt; 57&lt;/span&gt;     &lt;span&gt;int&lt;/span&gt; x=&lt;span&gt;1&lt;/span&gt;,y=&lt;span&gt;1&lt;/span&gt;,z=&lt;span&gt;1&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 58&lt;/span&gt;     &lt;span&gt;while&lt;/span&gt; (x&amp;lt;=numh||y&amp;lt;=numh||z&amp;lt;=&lt;span&gt;nums){
&lt;/span&gt;&lt;span&gt; 59&lt;/span&gt;         &lt;span&gt;int&lt;/span&gt; a=&lt;span&gt;0&lt;/span&gt;,b=&lt;span&gt;0&lt;/span&gt;,c=&lt;span&gt;0&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 60&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (L[x+a].p&amp;lt;=R[y].p&amp;amp;&amp;amp;L[x+a].p&amp;lt;=&lt;span&gt;ts[z].x){
&lt;/span&gt;&lt;span&gt; 61&lt;/span&gt; &lt;span&gt;            q.insert(Th[L[x].id].y);
&lt;/span&gt;&lt;span&gt; 62&lt;/span&gt;             a++&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 63&lt;/span&gt;             &lt;span&gt;while&lt;/span&gt; (L[x+a-&lt;span&gt;1&lt;/span&gt;].p==L[x+a].p) q.insert(Th[L[x+a].id].y),a++;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;把相同左端点的都加到set中 &lt;/span&gt;
&lt;span&gt; 64&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt; 65&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (ts[z+c].x&amp;lt;=L[x].p&amp;amp;&amp;amp;ts[z+c].x&amp;lt;=&lt;span&gt;R[y].p){
&lt;/span&gt;&lt;span&gt; 66&lt;/span&gt;             It s=&lt;span&gt;q.lower_bound(ts[z].l);
&lt;/span&gt;&lt;span&gt; 67&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (*s&amp;lt;=ts[z].r) &lt;span&gt;return&lt;/span&gt; &lt;span&gt;true&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 68&lt;/span&gt;             c++&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 69&lt;/span&gt;             &lt;span&gt;while&lt;/span&gt; (ts[z+c-&lt;span&gt;1&lt;/span&gt;].x==ts[z+c].x){&lt;span&gt;//&lt;/span&gt;&lt;span&gt;查询，意义同上面 &lt;/span&gt;
&lt;span&gt; 70&lt;/span&gt;                 It s=q.lower_bound(ts[z+&lt;span&gt;c].l);
&lt;/span&gt;&lt;span&gt; 71&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (*s&amp;lt;=ts[z+c].r) &lt;span&gt;return&lt;/span&gt; &lt;span&gt;true&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 72&lt;/span&gt;                 c++&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 73&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt; 74&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt; 75&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (R[y].p&amp;lt;=L[x].p&amp;amp;&amp;amp;R[y].p&amp;lt;=&lt;span&gt;ts[z].x){
&lt;/span&gt;&lt;span&gt; 76&lt;/span&gt; &lt;span&gt;            q.erase(Th[R[y].id].y);
&lt;/span&gt;&lt;span&gt; 77&lt;/span&gt;             b++&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 78&lt;/span&gt;             &lt;span&gt;while&lt;/span&gt; (R[y+b-&lt;span&gt;1&lt;/span&gt;].p==R[y+b].p) q.erase(Th[R[y+b].id].y),b++;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;删除，意义同上 &lt;/span&gt;
&lt;span&gt; 79&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt; 80&lt;/span&gt;         x+=a; y+=b; z+=c;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;不能直接把指针向后移 &lt;/span&gt;
&lt;span&gt; 81&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 82&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt; &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 83&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 84&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; main(){
&lt;/span&gt;&lt;span&gt; 85&lt;/span&gt;     scanf(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;%d&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;,&amp;amp;&lt;span&gt;n);
&lt;/span&gt;&lt;span&gt; 86&lt;/span&gt;     &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i=&lt;span&gt;1&lt;/span&gt;;i&amp;lt;=n;i++&lt;span&gt;){
&lt;/span&gt;&lt;span&gt; 87&lt;/span&gt;         scanf(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;%d%d%d%d&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;,&amp;amp;x1,&amp;amp;y1,&amp;amp;x2,&amp;amp;&lt;span&gt;y2);
&lt;/span&gt;&lt;span&gt; 88&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (x1&amp;gt;&lt;span&gt;x2) swap(x1,x2);
&lt;/span&gt;&lt;span&gt; 89&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (y1&amp;gt;&lt;span&gt;y2) swap(y1,y2);
&lt;/span&gt;&lt;span&gt; 90&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (x1==&lt;span&gt;x2){
&lt;/span&gt;&lt;span&gt; 91&lt;/span&gt;             s[++cnt1].x=x1; s[cnt1].l=y1; s[cnt1].r=y2; s[cnt1].len=y2-&lt;span&gt;y1;
&lt;/span&gt;&lt;span&gt; 92&lt;/span&gt;         } &lt;span&gt;else&lt;/span&gt;&lt;span&gt;{
&lt;/span&gt;&lt;span&gt; 93&lt;/span&gt;             h[++cnt2].y=y1; h[cnt2].l=x1; h[cnt2].r=x2; h[cnt2].len=x2-&lt;span&gt;x1;
&lt;/span&gt;&lt;span&gt; 94&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt; 95&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 96&lt;/span&gt;     l=&lt;span&gt;1&lt;/span&gt;; r=1e9; ans=&lt;span&gt;1e9;
&lt;/span&gt;&lt;span&gt; 97&lt;/span&gt;     &lt;span&gt;while&lt;/span&gt; (l&amp;lt;=&lt;span&gt;r){
&lt;/span&gt;&lt;span&gt; 98&lt;/span&gt;         &lt;span&gt;int&lt;/span&gt; mid=(l+r)&amp;gt;&amp;gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 99&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (check(mid)){
&lt;/span&gt;&lt;span&gt;100&lt;/span&gt;             ans=mid; l=mid+&lt;span&gt;1&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;101&lt;/span&gt;         } &lt;span&gt;else&lt;/span&gt; r=mid-&lt;span&gt;1&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;102&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;103&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (ans!=1e9) printf(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;%d\n&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;,ans);
&lt;/span&gt;&lt;span&gt;104&lt;/span&gt;             &lt;span&gt;else&lt;/span&gt; puts(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Human intelligence is really terrible&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;105&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt; &lt;span&gt;0&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;106&lt;/span&gt; }
&lt;/pre&gt;</description>
<pubDate>Wed, 11 Oct 2017 23:12:00 +0000</pubDate>
<dc:creator>I__am</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/zhuchenrui/p/7654365.html</dc:identifier>
</item>
<item>
<title>初学者易上手的SSH-struts2 01环境搭建 - 柯一</title>
<link>http://www.cnblogs.com/lzx2509254166/p/7653695.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/lzx2509254166/p/7653695.html</guid>
<description>&lt;p&gt;集成SSH框架的系统从职责上分为四层：表示层、业务逻辑层、数据持久层和域模块层（实体层）。&lt;/p&gt;
&lt;p&gt; &lt;span lang=&quot;en-US&quot;&gt;Struts&lt;span lang=&quot;zh-CN&quot;&gt;作为系统的&lt;span lang=&quot;zh-CN&quot;&gt;整体基础架构，负责MVC的分离，在Struts框架的模型部分，控制业务跳转，利用Hibernate框架对持久层提供支持&lt;span lang=&quot;zh-CN&quot;&gt;。&lt;span lang=&quot;zh-CN&quot;&gt;Spring&lt;span lang=&quot;zh-CN&quot;&gt;一方面作为一个轻量级的&lt;span lang=&quot;en-US&quot;&gt;IoC&lt;span lang=&quot;zh-CN&quot;&gt;容器，负责查找、定位、创建和管理对象及对象之间的依赖关系，另一方面能使&lt;span lang=&quot;en-US&quot;&gt;Struts&lt;span lang=&quot;zh-CN&quot;&gt;和&lt;span lang=&quot;en-US&quot;&gt;Hibernate&lt;span lang=&quot;zh-CN&quot;&gt;更好地工作。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang=&quot;en-US&quot;&gt;&lt;span lang=&quot;zh-CN&quot;&gt;今天我们首先接触SSH中的struts2,而什么是struts2呢？简单的来说:它通过采用 Java Servlet/JSP 技术，实现了基于Java EEWeb应用的MVC设计模式的应用框架，是MVC经典设计模式中的一个经典产品。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang=&quot;en-US&quot;&gt;&lt;span lang=&quot;zh-CN&quot;&gt;多的就不说了，直接进入今天的主题，struts2环境搭建。使用的工具:eclipse,tomcat8,struts2版本为2.3.24.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang=&quot;en-US&quot;&gt;&lt;span lang=&quot;zh-CN&quot;&gt;第一步:打开eclipse新建一个web project.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang=&quot;en-US&quot;&gt;&lt;span lang=&quot;zh-CN&quot;&gt;第二步:将struts2的jar包导入到刚建好的项目中的WebContent下的WEB-INF下的lib中。struts2的jar包可自己在它的官网下载&lt;a href=&quot;http://struts.apache.org/download.cgi&quot; target=&quot;_blank&quot;&gt;http://struts.apache.org/download.cgi&lt;/a&gt;&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang=&quot;en-US&quot;&gt;&lt;span lang=&quot;zh-CN&quot;&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1087295/201710/1087295-20171011195058527-501348379.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;第三步:在项目中的Java Resources下的src中新建一个Pageage,取名为com.action.在com.action中新建一个class,叫做LoginAction。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1087295/201710/1087295-20171011195850668-1342351798.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;第四步:打开LoginAction,继承ActionSupport这个类,实现execute这个默认方法，方法中返回一个SUCCESS（枚举值），你可以选中这个值，按住ctrl建点击进入，查看到其他的枚举值。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1087295/201710/1087295-20171011200212652-1463001319.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;第四步:同样在src下建立一个struts.xml的配置文件。而xml文件需要引入dtd的规范，而这个规范可以在处于src文件夹同级的Libraries中的Web App Libraries下的struts2-core-2.3.24.jar中的struts-default.xml中找到。找到后copy到struts.xml中即可。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1087295/201710/1087295-20171012003627105-1148020869.png&quot; alt=&quot;&quot;/&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1087295/201710/1087295-20171012003653387-410374147.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;这个时候你就可以开始配置这个xml文件了。不过在这之前，你可能会发现一个问题，就是在配置的时候竟然没有提示!那么你还得先把提示给整出来，当然你也可以纯手动输入。配置提示步骤如下:首先，选择eclipse上面菜单栏的window然后preferences，直接输入catalog，然后点击Add,再选择左边的Catalog Entry,然后开始右边操作。要填Location那个框框的路径，那你得找到你的struts2-core-2.3.24.jar这个jar包，然后把它解压，你会发现解压后有几个后缀名为dtd.文件，因为我用的2.3这个版本，所以我导的是2.3这个文件的路径，将Key type 改成URI,key的话你就把你struts.xml配置文件引入的dtd规范上面的http://struts.apache.org/dtds/struts-2.3.dtd复制进去,点击OK即可。然后把struts.xml重新打开即可有提示。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1087295/201710/1087295-20171012010116371-1278036978.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;


&lt;p&gt;接着开始配置struts.xml吧。步骤如图。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1087295/201710/1087295-20171012011047887-1141621870.png&quot; alt=&quot;&quot;/&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1087295/201710/1087295-20171012011323355-989116650.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;其中要注意一个地方，&amp;lt;result&amp;gt;节点当中name属性不要因为LoginAction中返回的是一个大写，就写大写，注意要小写!&lt;/p&gt;
&lt;p&gt;最后一步，需要在项目中的WebContent下的WEB-INF下的web.xml中进行过滤器的配置。如图&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1087295/201710/1087295-20171012011617902-509524108.png&quot; alt=&quot;&quot;/&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1087295/201710/1087295-20171012011659543-884722760.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;其中的 &lt;span class=&quot;Apple-tab-span&quot;&gt;&amp;lt;filter-class&amp;gt;org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter&amp;lt;/filter-class&amp;gt;&lt;/span&gt;可以使用快捷键ctrl+shift+t，输入strutsp进行查找。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1087295/201710/1087295-20171012012020887-702016399.png&quot; alt=&quot;&quot;/&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1087295/201710/1087295-20171012012026496-1382001136.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;到此struts2的环境就搭建好了。你可以启动服务，打开谷歌浏览器，输入localhost:8080/你的项目名/你的地址名.action进行尝试。&lt;/p&gt;

</description>
<pubDate>Wed, 11 Oct 2017 17:31:00 +0000</pubDate>
<dc:creator>柯一</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/lzx2509254166/p/7653695.html</dc:identifier>
</item>
<item>
<title>运行Vue在ASP.NET Core应用程序并部署在IIS上 - Jeffcky</title>
<link>http://www.cnblogs.com/CreateMyself/p/7643014.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/CreateMyself/p/7643014.html</guid>
<description>&lt;p&gt;从.NET Core 1.0开始我们就将其应用到项目中，但是呢我对ASP.NET Core一些原理也还未开始研究，仅限于会用，不过园子中已有大量文章存在，借着有点空余时间，我们来讲讲如何利用ASP.NET Core结合Vue在IIS上运行。&lt;/p&gt;
&lt;h2&gt;ASP.NET Core结合Vue部署于IIS&lt;/h2&gt;
&lt;p&gt;关于安装Vue和Webpack则不再叙述，我们直接来创建ASP.NET Core应用程序或者通过dotnet new mvc创建ASP.NET Core应用程序&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/589642/201710/589642-20171011202654762-1671399268.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;接下来在上述应用程序下通过如下命令创建Vue模板&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
vue init webpack my-&lt;span&gt;project
cd my&lt;/span&gt;-&lt;span&gt;project
npm install&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/589642/201710/589642-20171012000239887-71903653.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;接下来我们利用npm run dev启动Vue.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/589642/201710/589642-20171012004940387-2107867379.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;此时Vue也运行起来，我们则可以很嗨森的在本地进行测试了。完成了第一步，然后我们在生产环境实现前后分离，将上述ASP.NET Core应用程序部署到IIS作为一个单独站点，与此同时将Vue也作为一个单独站点。接下来我们将上述应用程序部署到IIS上。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/589642/201710/589642-20171012001043355-1380573657.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;在IIS上创建的站点aspnetcore，其基本设置中应用程序池当然为无托管代码，如果没有请自行下载.NET Core run time。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/589642/201710/589642-20171012011444277-342518972.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/589642/201710/589642-20171012002130418-332807792.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;此时我们需要做的则是修改Vue配置文件，修改生成的Vue模板项目config文件夹下的Index.js文件来配置生成文件所在目录，如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/589642/201710/589642-20171012005756043-1474170804.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;接下来再运行npm run build命令将在wwwroot文件夹下生成vue文件。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/589642/201710/589642-20171012010011309-905708128.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;然后我们创建前端站点将上述生成的文件放到该站点下，比如我创建的是VueDemo。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/589642/201710/589642-20171012010146840-1219499668.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;是不是一切看起来都是那么简单和easy呢，可能在你进行如上测试时会出现很多问题，我只是未做详细说明而已，比如没有权限访问啊，那就给定权限诺，默认情况下站点权限为IIS APPPOOL\DefaultAppPool ，要是权限不够就配置NET SERVICE或者EVERY ONE，再要么是创建的Vue站点无法访问出现对应的错误代码，此时需要通过Web平台安装路由重写程序。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/589642/201710/589642-20171012010928105-649236808.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;h2&gt;总结 &lt;/h2&gt;
&lt;p&gt;本节我们简短介绍了如何实现ASP.NET Core应用程序与前端框架（如Vue）前后分离，上述完成后接下来则是Vue进行接口调用了，有时间会更新利用Vue进行Ajax请求ASP.NET Core接口，如果上述创建过程中出现任何坑而无法解决可直接私信我，一一为你解答。see u。&lt;/p&gt;
</description>
<pubDate>Wed, 11 Oct 2017 17:13:00 +0000</pubDate>
<dc:creator>Jeffcky</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/CreateMyself/p/7643014.html</dc:identifier>
</item>
<item>
<title>项目管理碎碎念系列之一：干系人管理 - 司想君</title>
<link>http://www.cnblogs.com/depsi/p/7653666.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/depsi/p/7653666.html</guid>
<description>&lt;p&gt;初次见到“项目干系人”这个词，我是有点蒙圈的，因为这不太符合中文平时的表达。&lt;/p&gt;

&lt;p&gt;其实所谓“项目干系人”，英文称作“Project Stakeholder”，翻译成利益相关者，对其含义就一目了然了。再借用人们常说的一句“与你脱不了干系”，就能明白“干系人”是责任相关者，由此我们就可以引申出“项目干系人”的概念：&lt;/p&gt;

&lt;blockquote readability=&quot;7&quot;&gt;
&lt;p&gt;参与项目的有关各方，其利益会受到项目正面或负面影响的任何组织或个人，以及能对项目活动或结果施加影响的任何组织或个人。简单地说，与项目有直接或间接关系的任何组织或个人，都是项目干系人。&lt;/p&gt;
&lt;/blockquote&gt;


&lt;p&gt;或许有人会问了，做一个项目给别人带来正面影响我理解，负面影响从哪里来？其实拆迁项目就是典型的例子，不让所有住户都满意，项目是没法顺利进行的。&lt;/p&gt;

&lt;p&gt;项目干系人既然如此重要，那么就需要对干系人进行管理。管理之前，首先要识别出哪些人是干系人，而且要&lt;strong&gt;尽早开展、尽量全面、持续进行&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;下面介绍几个重要的干系人：&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;项目发起人。&lt;/strong&gt;发起人最重要的作用是，给钱，给钱，给钱，说三遍。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;高级管理层。&lt;/strong&gt;如果项目是公司内部的，一般高级管理层就是项目发起人；如果是跨公司的，项目发起人委托承接项目公司的高级管理层来开展项目。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;客户。&lt;/strong&gt;客户是项目产品的使用者，既包括直接使用者，也包括间接使用者。好比一款药，病人是直接使用者，开药的医生是间接使用者。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;项目经理。&lt;/strong&gt;项目经理往往责任大于职权。没有实际权利，却要负责把项目做成功。这也是项目经理这个岗位最有价值的所在。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;项目团队。&lt;/strong&gt;包括项目管理团队和狭义的项目团队（执行团队）。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;职能经理和职能部门。&lt;/strong&gt;专业人才的掌控部门，如财务部。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;卖方和合作伙伴。&lt;/strong&gt;通过合同提供成果，是卖方；通过协议进行合作，是伙伴。&lt;/p&gt;

&lt;p&gt;了解了主要的干系人，再来看看识别干系人的重要工具：&lt;strong&gt;干系人分析技术。&lt;/strong&gt;PMBOK指南提到了三种常见的方格模型：&lt;/p&gt;
&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;
&lt;p&gt;权力/利益方格&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;权力/影响方格&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;影响/作用方格&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;还有一个凸显模型，分为干系人施加影响的能力、紧急程度和合法性三个维度。&lt;/p&gt;

&lt;p&gt;识别出了干系人，就要产生&lt;strong&gt;干系人登记册&lt;/strong&gt;。包括干系人的姓名、联系方式、要求和期望，可能对项目的影响等等。如下图所示是一个典型的干系人登记册：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/849146/201710/849146-20171012005541434-1489310440.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;img class=&quot;img_loading&quot; src=&quot;data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==&quot; alt=&quot;&quot; data-s=&quot;300,640&quot; data-type=&quot;jpeg&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/OMpRmkY6ANmscicl1bgibbibUaicYKCsIsdK4LLVWtkFpftMtTFYTeEM7oAZQbjr9ADvBh2RmDBuuIvY1TcmnuH9tA/0?wx_fmt=jpeg&quot; data-ratio=&quot;0.19027777777777777&quot; data-w=&quot;720&quot;/&gt;&lt;/p&gt;
&lt;p&gt;干系人登记册需要在整个项目周期内不断更新。&lt;/p&gt;

&lt;p&gt;识别出干系人，就要对干系人管理进行规划，生成&lt;strong&gt;干系人管理计划&lt;/strong&gt;，将来按照这个计划进行管理。这个计划中，对干系人列出了从低到高的五种参与程度：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;无知型。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;抵触型。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;中立型。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;支持型。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;领导型。&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;有了计划，接下来就是实打实的跟关系人打交道了。通过这个过程，要把干系人实际参与项目的程度提高到项目经理期望的程度。打交道的过程中遇到了问题，要记录到&lt;strong&gt;问题日志&lt;/strong&gt;当中去。这个过程中也可能出现变更请求，比如某个干系人的需求变了。&lt;/p&gt;

&lt;p&gt;最后，就是要对干系人的参与进行全程监控。要把干系人实际参与项目的程度和计划要求的程度进行比较形成工作绩效信息。&lt;/p&gt;

&lt;p&gt;点睛：项目经理90%的时间都是在沟通，和谁沟通？干系人！&lt;/p&gt;
&lt;img src=&quot;data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==&quot; alt=&quot;&quot; data-type=&quot;xmt-style-img&quot; data-src=&quot;http://mmbiz.qpic.cn/mmbiz_png/Az5ZsrEic9ot90z9etZLlU7OTaPOdibteezvkcko7DiaROw1xrIKg67w23iaPARVIXxC2miaNB2zkH2JZWyhIdoRqiaQ/0&quot; data-ratio=&quot;1&quot; data-w=&quot;30&quot;/&gt;</description>
<pubDate>Wed, 11 Oct 2017 16:57:00 +0000</pubDate>
<dc:creator>司想君</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/depsi/p/7653666.html</dc:identifier>
</item>
<item>
<title>Go语言备忘录：反射的原理与使用详解 - SuriFuture</title>
<link>http://www.cnblogs.com/susufufu/p/7653579.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/susufufu/p/7653579.html</guid>
<description>&lt;pre class=&quot;brush:go;gutter:true;&quot;&gt;
package main

import (
        &quot;reflect&quot;
        &quot;strings&quot;
        &quot;fmt&quot;
)
//通用算法函数体模板
func add(args []reflect.Value) (results []reflect.Value) {
        if len(args) == 0 {
                return nil
        }
        var r reflect.Value
        switch args[0].Kind() {
        case reflect.Int:
                n:=0
                for _,a:=range args{
                        n+=int(a.Int())
                }
                r = reflect.ValueOf(n)
        case reflect.String:
                ss := make([]string,0,len(args))
                for _,s:=range args{
                        ss = append(ss,s.String())
                }
                r=reflect.ValueOf(strings.Join(ss,&quot;&quot;))
        }
        results = append(results,r)
        return
}
func makeAdd(T interface{})  {
        fn:=reflect.ValueOf(T).Elem()
        v:=reflect.MakeFunc(fn.Type(),add) //把原始函数变量的类型和通用算法函数存到同一个Value中
        fn.Set(v)  //把原始函数指针变量指向v，这样它就获得了函数体
}
func main() {
    //定义函数变量，未定义函数体
        var intAdd func(x,y int) int
        var strAdd func(a,b string) string

        makeAdd(&amp;amp;intAdd)
        makeAdd(&amp;amp;strAdd)

        fmt.Println(intAdd(12,23))  //35
        fmt.Println(strAdd(&quot;hello, &quot;,&quot;world!&quot;)) //hello, world!
}
&lt;/pre&gt;</description>
<pubDate>Wed, 11 Oct 2017 16:02:00 +0000</pubDate>
<dc:creator>SuriFuture</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/susufufu/p/7653579.html</dc:identifier>
</item>
<item>
<title>Python操作excel表格 - 张璨</title>
<link>http://www.cnblogs.com/zhang-can/p/7652702.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/zhang-can/p/7652702.html</guid>
<description>&lt;p&gt;用Python操作Excel在工作中还是挺常用的，因为毕竟不懂Excel是一个用户庞大的数据管理软件&lt;/p&gt;
&lt;p&gt;注：本篇代码在Python3环境下运行&lt;/p&gt;
&lt;p&gt;首先导入两个模块xlrd和xlwt，xlrd用来读取Excel表格，xlwt是写Excel表格&lt;/p&gt;
&lt;p&gt;在命令提示行输入命令：&lt;/p&gt;
&lt;p&gt;　　pip install xlrd&lt;/p&gt;
&lt;p&gt;　　pip install xlwt&lt;/p&gt;
&lt;p&gt;下面我们学习一下这两个模块的使用&lt;/p&gt;
&lt;p&gt;一、xlrd&lt;/p&gt;
&lt;p&gt;1.首先导入模块，import xlrd&lt;/p&gt;
&lt;p&gt;2.先写一个表用来实验，表的内容是这样的：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1164899/201710/1164899-20171011195058371-1392657403.png&quot; alt=&quot;&quot; width=&quot;385&quot; height=&quot;93&quot;/&gt;&lt;/p&gt;

&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;import&lt;/span&gt;&lt;span&gt; xlrd

file_path &lt;/span&gt;= &lt;span&gt;'&lt;/span&gt;&lt;span&gt;1.xlsx&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;

xlrd.Book.encoding &lt;/span&gt;= &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;utf8&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;#&lt;/span&gt;&lt;span&gt;设置编码&lt;/span&gt;
data = xlrd.open_workbook(file_path)&lt;span&gt;#&lt;/span&gt;&lt;span&gt;打开文件&lt;/span&gt;
sheet_names = data.sheet_names()  &lt;span&gt;#&lt;/span&gt;&lt;span&gt;查看文件中包含sheet的名称&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;获取工作簿，有三种方式&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;#&lt;/span&gt;&lt;span&gt; table = data.sheets()[0]&lt;/span&gt;&lt;span&gt;
#&lt;/span&gt;&lt;span&gt; table = data.sheet_by_name('Sheet1')&lt;/span&gt;
table = data.sheet_by_index(0) &lt;span&gt;#&lt;/span&gt;&lt;span&gt;取第一张工作簿(三种方法）&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;获取总行数和总列数&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
rows_count = table.nrows &lt;span&gt;#&lt;/span&gt;&lt;span&gt;取总行数&lt;/span&gt;
cols_count = table.ncols&lt;span&gt;#&lt;/span&gt;&lt;span&gt;取总列数&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt; 获取第一行及第一列数据&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
row_data = table.row_values(0)&lt;span&gt;#&lt;/span&gt;&lt;span&gt;获取第一行数据(数组)&lt;/span&gt;
col_data = table.col_values(0)&lt;span&gt;#&lt;/span&gt;&lt;span&gt;获取第一列数据(数组)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;获取某个单元格的值&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
cell_data = row_data[0]  &lt;span&gt;#&lt;/span&gt;&lt;span&gt;取第0行第0列的值   战士&lt;/span&gt;
cell_data_A1 = table.cell(1, 1).value  &lt;span&gt;#&lt;/span&gt;&lt;span&gt;取第1行第1列的值    李白&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;循环读取所有数据&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
&lt;span&gt;for&lt;/span&gt; row &lt;span&gt;in&lt;/span&gt;&lt;span&gt; range(0,rows_count):
    &lt;/span&gt;&lt;span&gt;for&lt;/span&gt; col &lt;span&gt;in&lt;/span&gt;&lt;span&gt; range(0,cols_count):
        data1 &lt;/span&gt;=&lt;span&gt; table.cell(row,col).value
        &lt;/span&gt;&lt;span&gt;print&lt;/span&gt;(data1,end=&lt;span&gt;'&lt;/span&gt; &lt;span&gt;'&lt;/span&gt;&lt;span&gt;)
    &lt;/span&gt;&lt;span&gt;print&lt;/span&gt;(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;\n&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这是基本操作，下面扩展一点&lt;/p&gt;
&lt;p&gt;关于时间格式：&lt;/p&gt;
&lt;p&gt;　　看一下取时间那一列数据，得到的什么 &lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
[&lt;span&gt;'&lt;/span&gt;&lt;span&gt;时间&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, 42993.0, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;2017.01.12&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, 40900.0]
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这并不是我们想要的，这个时间格式是Excel中，以1900年1月1日为起始时间，以天为单位的得到的数据&lt;/p&gt;
&lt;p&gt;其实在这个模块中，有个属性可以显示单元格数据的类型，ctype,有这几种类型：&lt;/p&gt;
&lt;p&gt;　　ctype = 1 # 类型 0 empty,1 string, 2 number, 3 date, 4 boolean, 5 error&lt;/p&gt;
&lt;p&gt; 我们可以查看一下，它打印的这个是什么类型 &lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;print&lt;/span&gt;(table.cell(1,6).ctype)&lt;span&gt;#&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;
&lt;span&gt;print&lt;/span&gt;(table.cell(2,6).ctype)&lt;span&gt;#&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;
&lt;span&gt;print&lt;/span&gt;(table.cell(3,6).ctype)&lt;span&gt;#&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;原来他能识别这是时间格式，那我们要处理一下了，让他显示格式化时间&lt;/p&gt;
&lt;p&gt;可以用这条命令来转换一下&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;43.5&quot;&gt;
&lt;pre readability=&quot;10&quot;&gt;
date_value = xlrd.xldate_as_tuple(table.cell_value(1,6),data.datemode)&lt;p&gt;print(date_value)#(2017, 9, 15, 0, 0, 0)
&lt;/p&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;这个格式就可以用了&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt;from&lt;/span&gt; datetime &lt;span&gt;import&lt;/span&gt;&lt;span&gt; date,datetime

&lt;/span&gt;&lt;span&gt;print&lt;/span&gt;(date(*date_value[:3]))&lt;span&gt;#&lt;/span&gt;&lt;span&gt;2017-09-15  &lt;/span&gt;

&lt;span&gt;print&lt;/span&gt;(date(*date_value[:3]).strftime(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;%Y/%m/%d&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;))&lt;span&gt;#&lt;/span&gt;&lt;span&gt;2017/09/15&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;所以当我们循环读取并打印数据的时候，可以做一个判断，如果数据的ctype为3，就做这样一个转换&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;42&quot;&gt;
&lt;pre&gt;
&lt;span&gt;for&lt;/span&gt; row &lt;span&gt;in&lt;/span&gt;&lt;span&gt; range(0,rows_count):
    &lt;/span&gt;&lt;span&gt;for&lt;/span&gt; col &lt;span&gt;in&lt;/span&gt;&lt;span&gt; range(0,cols_count):
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (table.cell(row, col).ctype == 3):&lt;span&gt;#&lt;/span&gt;&lt;span&gt;如果读到时间格式的数据，就转换&lt;/span&gt;
            data_value =&lt;span&gt; xlrd.xldate_as_tuple(table.cell_value(row, col), data.datemode)
            data1 &lt;/span&gt;= date(*data_value[:3]).strftime(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;%Y/%m/%d&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;)
        &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt;:
            data1 &lt;/span&gt;=&lt;span&gt; table.cell(row,col).value
        &lt;/span&gt;&lt;span&gt;print&lt;/span&gt;(data1,end=&lt;span&gt;'&lt;/span&gt; &lt;span&gt;'&lt;/span&gt;&lt;span&gt;)
    &lt;/span&gt;&lt;span&gt;print&lt;/span&gt;(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;\n&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;)
&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt;战士 刺客 法师 坦克 辅助 射手 时间 

老夫子 李白 甄姬 亚瑟 蔡文姬 鲁班 &lt;/span&gt;2017/09/15&lt;span&gt; 

杨戬 韩信 小乔 牛魔 大乔 狄仁杰 &lt;/span&gt;2017.01.12&lt;span&gt; 

典韦 赵云 妲己 钟无艳 孙斌 虞姬 &lt;/span&gt;2011/12/23 
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;其实，xlrd也能实现简单的修改数据，但是这只是临时的修改，好像并没有什么用&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;48&quot;&gt;
&lt;pre&gt;
&lt;span&gt;#&lt;/span&gt;&lt;span&gt;简单的写入数据&lt;/span&gt;
row = 1&lt;span&gt;
col &lt;/span&gt;=&lt;span&gt; 0
ctype &lt;/span&gt;= 1 &lt;span&gt;#&lt;/span&gt;&lt;span&gt; 类型 0 empty,1 string, 2 number, 3 date, 4 boolean, 5 error&lt;/span&gt;
value = &lt;span&gt;'&lt;/span&gt;&lt;span&gt;1212&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;
xf &lt;/span&gt;= 0 &lt;span&gt;#&lt;/span&gt;&lt;span&gt; 扩展的格式化 (默认是0)&lt;/span&gt;
&lt;span&gt;table.put_cell_unragged(row, col, ctype, value, xf)
table.put_cell(row, col, ctype, value, xf)&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;只是暂时的修改，而且只能是修改已有的数据&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然后再读取数据：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;42&quot;&gt;
&lt;pre&gt;
&lt;span&gt;for&lt;/span&gt; row &lt;span&gt;in&lt;/span&gt;&lt;span&gt; range(0,rows_count):
    &lt;/span&gt;&lt;span&gt;for&lt;/span&gt; col &lt;span&gt;in&lt;/span&gt;&lt;span&gt; range(0,cols_count):
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (table.cell(row, col).ctype == 3):&lt;span&gt;#&lt;/span&gt;&lt;span&gt;如果读到时间格式的数据，就转换&lt;/span&gt;
            data_value =&lt;span&gt; xlrd.xldate_as_tuple(table.cell_value(row, col), data.datemode)
            data1 &lt;/span&gt;= date(*data_value[:3]).strftime(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;%Y/%m/%d&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;)
        &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt;:
            data1 &lt;/span&gt;=&lt;span&gt; table.cell(row,col).value
        &lt;/span&gt;&lt;span&gt;print&lt;/span&gt;(data1,end=&lt;span&gt;'&lt;/span&gt; &lt;span&gt;'&lt;/span&gt;&lt;span&gt;)
    &lt;/span&gt;&lt;span&gt;print&lt;/span&gt;(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;\n&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;拿到的结果就是修改了的，但是这只是临时的，原表格并没有修改&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt;战士 刺客 法师 坦克 辅助 射手 时间 

&lt;/span&gt;1212 李白 甄姬 亚瑟 蔡文姬 鲁班 2017/09/15&lt;span&gt; 

杨戬 韩信 小乔 牛魔 大乔 狄仁杰 &lt;/span&gt;2017.01.12&lt;span&gt; 

典韦 赵云 妲己 钟无艳 孙斌 虞姬 &lt;/span&gt;2011/12/23 
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;关于合并的单元格的读取&lt;/p&gt;
&lt;p&gt;默认读取合并的单元格的时候，只会在合并单元格出现的第一个位置有值，其他合并的位置 就是空了，我们可以拿到合并的单元格所在表中的位置&lt;/p&gt;
&lt;p&gt;用一张新表，内容如下&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1164899/201710/1164899-20171011203634684-1090434890.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;div class=&quot;cnblogs_code&quot; readability=&quot;58&quot;&gt;
&lt;pre&gt;
workbook = xlrd.open_workbook(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;2.xlsx&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;)
table2 &lt;/span&gt;=&lt;span&gt; workbook.sheet_by_index(0) 
&lt;/span&gt;&lt;span&gt;print&lt;/span&gt;(table2.merged_cells)&lt;span&gt;#&lt;/span&gt;&lt;span&gt;[(3, 5, 3, 4), (3, 5, 0, 1)]  读取表中有合并单元格的位置&lt;br/&gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;pre&gt;
#merged_cells返回的这四个参数的含义是：(row,row_range,col,col_range),其中[row,row_range)&lt;br/&gt;# 即(3, 5, 3, 4)的含义是：第3到4列（3,4）的第4到5行（3,5）合并，(3, 5, 0, 1)的含义是：第0到1列（0,1）的第4到5行（3，5）合并。
&lt;/pre&gt;
&lt;pre&gt;
&lt;span&gt; &lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;
&lt;/pre&gt;
&lt;p&gt;二、xlwt&lt;/p&gt;
&lt;p&gt;1.导入模块 import xlwt&lt;/p&gt;
&lt;p&gt;2.创建工作簿，工作表&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
myWorkbook = xlwt.Workbook()&lt;span&gt;#&lt;/span&gt;&lt;span&gt;创建一个工作簿&lt;/span&gt;
mySheet = myWorkbook.add_sheet(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;A Test Sheet&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;)&lt;span&gt;#&lt;/span&gt;&lt;span&gt;创建一个工作表&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;3.创建数据格式，写入数据&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;48&quot;&gt;
&lt;pre&gt;
myStyle = xlwt.easyxf(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;font: name Times New Roman, color-index red, bold on&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, num_format_str=&lt;span&gt;'&lt;/span&gt;&lt;span&gt;#,##0.00&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;)&lt;span&gt;#&lt;/span&gt;&lt;span&gt;数据格式&lt;/span&gt;
mySheet.write(3, 0,&lt;span&gt;'&lt;/span&gt;&lt;span&gt;abcd&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, myStyle)&lt;span&gt;#&lt;/span&gt;&lt;span&gt;写数据的时候可以用这个格式，也可以不用&lt;/span&gt;
mySheet.write(2, 0, 1)&lt;span&gt;#&lt;/span&gt;&lt;span&gt;写入A3，数值等于1&lt;/span&gt;
mySheet.write(2, 1, 1)&lt;span&gt;#&lt;/span&gt;&lt;span&gt;写入B3，数值等于1&lt;/span&gt;
mySheet.write(2, 2, xlwt.Formula(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;A3+B3&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;))&lt;span&gt;#&lt;/span&gt;&lt;span&gt;写入C3，数值等于2&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;4.保存&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
myWorkbook.save(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;test.xls&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;)&lt;span&gt;#&lt;/span&gt;&lt;span&gt;保存&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

</description>
<pubDate>Wed, 11 Oct 2017 15:20:00 +0000</pubDate>
<dc:creator>张璨</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/zhang-can/p/7652702.html</dc:identifier>
</item>
<item>
<title>PE文件格式详解,第三讲,可选头文件格式,以及节表 - iBinary</title>
<link>http://www.cnblogs.com/iBinary/p/7653418.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/iBinary/p/7653418.html</guid>
<description>
&lt;p&gt;作者：IBinary&lt;br/&gt;出处：&lt;a href=&quot;http://www.cnblogs.com/iBinary/&quot; target=&quot;_blank&quot;&gt;http://www.cnblogs.com/iBinary/&lt;/a&gt;&lt;br/&gt;版权所有，欢迎保留原文链接进行转载：)&lt;/p&gt;
&lt;h2&gt;一丶可选头结构以及作用&lt;/h2&gt;
&lt;h2&gt; &lt;/h2&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;54&quot;&gt;
&lt;h2&gt;typedef struct _IMAGE_OPTIONAL_HEADER {&lt;/h2&gt;
&lt;pre&gt;
&lt;span&gt;
    WORD    Magic;　　　　　　　　　　　　　　　　　　/*机器型号,判断是PE是32位还是64位*/
    BYTE    MajorLinkerVersion;　　　　　　　　　　/*连接器版本号高版本*/
    BYTE    MinorLinkerVersion;　　　　　　　　　　/*连接器版本号低版本,组合起来就是 5.12 其中5是高版本,C是低版本*/
    DWORD   SizeOfCode;　　　　　　　　　　　　　　　/*代码节的总大小(512为一个磁盘扇区)*/
    DWORD   SizeOfInitializedData;　　　　　　　　/*初始化数据的节的总大小,也就是.data*/
    DWORD   SizeOfUninitializedData;　　　　　　 /*未初始化数据的节的大小,也就是 .data ? */
    DWORD   AddressOfEntryPoint;　　　　　　　　  /*程序执行入口(OEP) RVA(相对偏移)*/
    DWORD   BaseOfCode;　　　　　　　　　　　　　　 /*代码的节的起始RVA(相对偏移)也就是代码区的偏移,偏移+模块首地址定位代码区*/
    DWORD   BaseOfData;　　　　　　　　　　　　　　 /*数据结的起始偏移(RVA),同上*/&lt;/span&gt;&lt;span&gt;
    DWORD   ImageBase;　　　　　　　　　　　　　　　/*程序的建议模块基址(意思就是说作参考用的,模块地址在哪里)*/&lt;br/&gt;DWORD   SectionAlignment;　　　　　　　　　　　/*内存中的节对齐*/
    DWORD   FileAlignment;　　　　　　　　　　　　　/*文件中的节对齐*/
    WORD    MajorOperatingSystemVersion;　　　　/*操作系统版本号高位*/
    WORD    MinorOperatingSystemVersion;　　　　/*操作系统版本号低位*/
    WORD    MajorImageVersion;　　　　　　　　　　/*PE版本号高位*/
    WORD    MinorImageVersion;　　　　　　　　　　/*PE版本号低位*/
    WORD    MajorSubsystemVersion;　　　　　　　　/*子系统版本号高位*/
    WORD    MinorSubsystemVersion;　　　　　　　　/*子系统版本号低位*/
    DWORD   Win32VersionValue;　　　　　　　　　　/*32位系统版本号值,注意只能修改为4 5 6表示操作系统支持nt4.0 以上,5的话依次类推*/
    DWORD   SizeOfImage;　　　　　　　　　　　　   /*整个程序在内存中占用的空间(PE映尺寸)*/
    DWORD   SizeOfHeaders;　　　　　　　　　　　　/*所有头(头的结构体大小)+节表的大小*/
    DWORD   CheckSum;　　　　　　　　　　　　　　 /*校验和,对于驱动程序,可能会使用*/
    WORD    Subsystem;　　　　　　　　　　　　　　/*文件的子系统 :重要*/
    WORD    DllCharacteristics;　　　　　　　　 /*DLL文件属性,也可以成为特性,可能DLL文件可以当做驱动程序使用*/
    DWORD   SizeOfStackReserve;　　　　　　　　/*预留的栈的大小*/
    DWORD   SizeOfStackCommit;　　　　　　　　 /*立即申请的栈的大小(分页为单位)*/
    DWORD   SizeOfHeapReserve;　　　　　　　　/*预留的堆空间大小*/
    DWORD   SizeOfHeapCommit;　　　　　　　　 /*立即申请的堆的空间的大小*/
    DWORD   LoaderFlags;　　　　　　　　　　　　/*与调试有关*/
    DWORD   NumberOfRvaAndSizes;　　　　　　　/*下面的成员,数据目录结构的项目数量*/
    IMAGE_DATA_DIRECTORY DataDirectory[16];/*数据目录,默认16个,16是宏,这里方便直接写成16*/
} IMAGE_OPTIONAL_HEADER32, &lt;/span&gt;*PIMAGE_OPTIONAL_HEADER32;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;需要注意的成员:&lt;/p&gt;
&lt;h3&gt;1.PE类型&lt;/h3&gt;
&lt;p&gt;这个有宏定义了&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_NT_OPTIONAL_HDR32_MAGIC      0x10b　　　　/*32位PE*/
&lt;span&gt;#define&lt;/span&gt; IMAGE_NT_OPTIONAL_HDR64_MAGIC      0x20b　　　　/*64位PE*/
&lt;span&gt;#define&lt;/span&gt; IMAGE_ROM_OPTIONAL_HDR_MAGIC       0x107　　　　/*其它,单片机*/
&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;2丶.OEP,程序执行入口位置.&lt;/h3&gt;
&lt;p&gt;我们利用昨天写的程序,可以完成一个反调试.&lt;/p&gt;
&lt;p&gt;思路:&lt;/p&gt;
&lt;p&gt;1.修改OEP偏移,置为0位置处(也就是MZ的位置)&lt;/p&gt;
&lt;p&gt;2.在MZ位置后面添加我们自己的代码&lt;/p&gt;
&lt;p&gt;3.添加完成之后,继续跳到以前OEP的位置.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171011212914809-530319449.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;首先,看PE文件的值,OEP的偏移位置是00001008偏移,那么OD调试,看下位置在哪里.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171011213007746-1592901233.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;我们知道了入口偏移是00401008位置,那么我们就知道了模块首地址是00400000&lt;/p&gt;
&lt;p&gt;公式  00401008 - 1008 = 00400000  因为我们知道1008是相对于模块地址来的所以可以求出模块地址,我们跳转过去&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171011213149965-1820093835.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;可以看出,前边正好是4D5A,那么我们可以修改一下,添加自己的代码,首先4D5A正好是汇编代码&lt;/p&gt;
&lt;p&gt;那么我们可以去平栈,然后跳转到我们以前的OEP位置.&lt;/p&gt;
&lt;p&gt;修改成下边那样&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171011223513715-1058671835.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;首先,我们以前讲DOS头的时候说过,如果这个EXE文件运行在32位系统下,那么DOS头中就地一个和最后一个成员有用,那么后面我们随便修改.&lt;/p&gt;
&lt;p&gt;上面代码很简单,首先栈平衡,然后跳转到我们以前代码执行位置.&lt;/p&gt;
&lt;p&gt;文件中(PE)我们把后面的二进制都修改为我们的代码&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171011223644824-1406935539.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;em id=&quot;__mceDel&quot;&gt;入后偏移(RVA)修改为0000000&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171011213759199-526761867.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;运行我们的程序,和调试我们的程序&lt;/p&gt;
&lt;p&gt;运行程序:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171011223709652-2124176970.png&quot; alt=&quot;&quot;/&gt;可以正常运行&lt;/p&gt;
&lt;p&gt;调试程序:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171011223744512-1087748612.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;程序出错,反调试了&lt;/p&gt;
&lt;h2&gt;二丶数据目录&lt;/h2&gt;
&lt;p&gt;数据目录,主要是存放各种表格的,看下&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
typedef &lt;span&gt;struct&lt;/span&gt;&lt;span&gt; _IMAGE_DATA_DIRECTORY {
    DWORD   VirtualAddress;　　　　　　　　虚拟地址(表格位置)
    DWORD   Size;　　　　　　　　　　　　　　大小
} IMAGE_DATA_DIRECTORY, &lt;/span&gt;*PIMAGE_DATA_DIRECTORY;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;关于表格,这里有很多宏定义.&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_DIRECTORY_ENTRY_EXPORT          0   &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Export Directory&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_DIRECTORY_ENTRY_IMPORT          1   &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Import Directory&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_DIRECTORY_ENTRY_RESOURCE        2   &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Resource Directory&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_DIRECTORY_ENTRY_EXCEPTION       3   &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Exception Directory&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_DIRECTORY_ENTRY_SECURITY        4   &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Security Directory&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_DIRECTORY_ENTRY_BASERELOC       5   &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Base Relocation Table&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_DIRECTORY_ENTRY_DEBUG           6   &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Debug Directory&lt;/span&gt;
&lt;span&gt;//&lt;/span&gt;&lt;span&gt;      IMAGE_DIRECTORY_ENTRY_COPYRIGHT       7   &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; (X86 usage)&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_DIRECTORY_ENTRY_ARCHITECTURE    7   &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Architecture Specific Data&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_DIRECTORY_ENTRY_GLOBALPTR       8   &lt;span&gt;//&lt;/span&gt;&lt;span&gt; RVA of GP&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_DIRECTORY_ENTRY_TLS             9   &lt;span&gt;//&lt;/span&gt;&lt;span&gt; TLS Directory&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG    10   &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Load Configuration Directory&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT   11   &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Bound Import Directory in headers&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_DIRECTORY_ENTRY_IAT            12   &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Import Address Table&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT   13   &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Delay Load Import Descriptors&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR 14   &lt;span&gt;//&lt;/span&gt;&lt;span&gt; COM Runtime descriptor&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;它是按照位来计算的.　　　　&lt;/p&gt;
&lt;h2&gt; 三丶节表&lt;/h2&gt;
&lt;p&gt;在NT头下面,紧跟着的是节表&lt;/p&gt;
&lt;p&gt;节表是什么意思? 可以理解为分区,就是几个区&lt;/p&gt;
&lt;p&gt;那么意思就是保存了区&lt;/p&gt;
&lt;p&gt;那么我们猜想一下,都需要什么成员&lt;/p&gt;
&lt;p&gt;地址&lt;/p&gt;
&lt;p&gt;地址大小&lt;/p&gt;
&lt;p&gt;文件中的地址&lt;/p&gt;
&lt;p&gt;文件大小&lt;/p&gt;
&lt;p&gt;等等....&lt;/p&gt;
&lt;p&gt;看下节表的信息吧&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
typedef &lt;span&gt;struct&lt;/span&gt;&lt;span&gt; _IMAGE_SECTION_HEADER {
    BYTE    Name[IMAGE_SIZEOF_SHORT_NAME];　　/*节区的名字*/
    union {
            DWORD   PhysicalAddress;
            DWORD   VirtualSize;　　　　　　　　/*节区的尺寸*/
    } Misc;
    DWORD   VirtualAddress;　　　　　　　　　　/*虚拟地址 节区的RVA地址(偏移)*/
    DWORD   SizeOfRawData;　　　　　　　　　　 /*在文件中对齐的尺寸*/
    DWORD   PointerToRawData;　　　　　　　　 /*在文件中的偏移*/
    DWORD   PointerToRelocations;　　　　　　/*在OBJ文件中使用*/
    DWORD   PointerToLinenumbers;　　　　　　/*行号表位置,调试使用*/
    WORD    NumberOfRelocations;　　　　　　/*在OBJ文件中使用*/
    WORD    NumberOfLinenumbers;　　　　　　/*行号表的数量*/
    DWORD   Characteristics;　　　　　　　　/*节的属性*/
} IMAGE_SECTION_HEADER, &lt;/span&gt;*PIMAGE_SECTION_HEADER;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;重要成员&lt;/p&gt;
&lt;p&gt;1.节的尺寸&lt;/p&gt;
&lt;p&gt;2.虚拟地址,RVA(偏移)&lt;/p&gt;
&lt;p&gt;3.文件中的大小&lt;/p&gt;
&lt;p&gt;4.文件中的偏移&lt;/p&gt;
&lt;p&gt;5.节的属性&lt;/p&gt;
&lt;p&gt;其中节的属性有很多,(表达这个分区是一个什么样的分区,代码区,常量区等等)&lt;/p&gt;
&lt;p&gt;看下宏定义(按位来的,可以看下第二讲的最后关于文件属性的讲解,其中讲解了这个怎么按位来)&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_SCN_CNT_CODE                   0x00000020  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Section contains code.&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_SCN_CNT_INITIALIZED_DATA       0x00000040  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Section contains initialized data.&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_SCN_CNT_UNINITIALIZED_DATA     0x00000080  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Section contains uninitialized data.&lt;/span&gt;

&lt;span&gt;#define&lt;/span&gt; IMAGE_SCN_LNK_OTHER                  0x00000100  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Reserved.&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_SCN_LNK_INFO                   0x00000200  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Section contains comments or some other type of information.&lt;/span&gt;
&lt;span&gt;//&lt;/span&gt;&lt;span&gt;      IMAGE_SCN_TYPE_OVER                  0x00000400  &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Reserved.&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_SCN_LNK_REMOVE                 0x00000800  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Section contents will not become part of image.&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_SCN_LNK_COMDAT                 0x00001000  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Section contents comdat.&lt;/span&gt;
&lt;span&gt;//&lt;/span&gt;&lt;span&gt;                                           0x00002000  &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Reserved.
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;      IMAGE_SCN_MEM_PROTECTED - Obsolete   0x00004000&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_SCN_NO_DEFER_SPEC_EXC          0x00004000  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Reset speculative exceptions handling bits in the TLB entries for this section.&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_SCN_GPREL                      0x00008000  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Section content can be accessed relative to GP&lt;/span&gt;

&lt;span&gt;#define&lt;/span&gt; IMAGE_SCN_LNK_NRELOC_OVFL            0x01000000  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Section contains extended relocations.&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_SCN_MEM_DISCARDABLE            0x02000000  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Section can be discarded.&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_SCN_MEM_NOT_CACHED             0x04000000  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Section is not cachable.&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_SCN_MEM_NOT_PAGED              0x08000000  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Section is not pageable.&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_SCN_MEM_SHARED                 0x10000000  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Section is shareable.&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_SCN_MEM_EXECUTE                0x20000000  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Section is executable.&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_SCN_MEM_READ                   0x40000000  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Section is readable.&lt;/span&gt;
&lt;span&gt;#define&lt;/span&gt; IMAGE_SCN_MEM_WRITE                  0x80000000  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Section is writeable.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;其中保留的没有写.&lt;/p&gt;
&lt;p&gt;作者：IBinary&lt;br/&gt;出处：&lt;a href=&quot;http://www.cnblogs.com/iBinary/&quot; target=&quot;_blank&quot;&gt;http://www.cnblogs.com/iBinary/&lt;/a&gt;&lt;br/&gt;版权所有，欢迎保留原文链接进行转载：)&lt;/p&gt;
</description>
<pubDate>Wed, 11 Oct 2017 15:09:00 +0000</pubDate>
<dc:creator>iBinary</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/iBinary/p/7653418.html</dc:identifier>
</item>
<item>
<title>C#泛型基础知识点总结 - 如此拉风的女人</title>
<link>http://www.cnblogs.com/wwym/p/7646935.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/wwym/p/7646935.html</guid>
<description>&lt;p&gt;&lt;span&gt;&lt;strong&gt;　　1.0&lt;/strong&gt;  &lt;strong&gt;什么是泛型&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;      泛型是&lt;strong&gt;C#2.0&lt;/strong&gt;和&lt;strong&gt;CLR（公共语言运行时）&lt;/strong&gt;升级的一个新特性，泛型为.NET 框架引入了一个叫 &lt;strong&gt;type parameters（类型参数）&lt;/strong&gt;的概念，&lt;strong&gt;type parameters&lt;/strong&gt; 使得程序在设计的时候，不必设计其具体的参数，其具体的参数可以延迟到需要的时候声明或调用。使用泛型代码运行时避免了类型转换的装箱和拆箱操作。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;　　&lt;strong&gt;2.0 泛型的延迟声明&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;38&quot;&gt;
&lt;pre&gt;
&lt;span&gt;&lt;span&gt; 1&lt;/span&gt;  &lt;span&gt;1&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System;
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;  &lt;span&gt;2&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System.Collections.Generic;
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;  &lt;span&gt;3&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System.Linq;
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;  &lt;span&gt;4&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System.Text;
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;  &lt;span&gt;5&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System.Threading.Tasks;
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;  &lt;span&gt;6&lt;/span&gt; 
&lt;span&gt; 7&lt;/span&gt;  &lt;span&gt;7&lt;/span&gt; &lt;span&gt;namespace&lt;/span&gt;&lt;span&gt; _20171010Generic
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;  &lt;span&gt;8&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;  &lt;span&gt;9&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span&gt;10&lt;/span&gt; &lt;span&gt;10&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt;&lt;span&gt; 泛型方法相关类&lt;/span&gt;
&lt;span&gt;11&lt;/span&gt; &lt;span&gt;11&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt;12&lt;/span&gt; &lt;span&gt;12&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; GenericMethod
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;13&lt;/span&gt;&lt;span&gt;     {
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; &lt;span&gt;14&lt;/span&gt;         &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span&gt;15&lt;/span&gt; &lt;span&gt;15&lt;/span&gt;         &lt;span&gt;///&lt;/span&gt;&lt;span&gt; 泛型方法：方法带&lt;/span&gt;&lt;span&gt;&amp;lt;&amp;gt;&lt;/span&gt;&lt;span&gt;和type parameters（类型参数 T）的&lt;/span&gt;
&lt;span&gt;16&lt;/span&gt; &lt;span&gt;16&lt;/span&gt;         &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt;17&lt;/span&gt; &lt;span&gt;17&lt;/span&gt;         &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;typeparam name=&quot;T&quot;&amp;gt;&amp;lt;/typeparam&amp;gt;&lt;/span&gt;
&lt;span&gt;18&lt;/span&gt; &lt;span&gt;18&lt;/span&gt;         &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;tParameters&quot;&amp;gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
&lt;span&gt;19&lt;/span&gt; &lt;span&gt;19&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Show&amp;lt;T&amp;gt;&lt;span&gt;(T tParameters)
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;20&lt;/span&gt;&lt;span&gt;         {
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;21&lt;/span&gt;             Console.WriteLine(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;{0}方法，parameter={1}参数，type={2}类型&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;, &lt;span&gt;typeof&lt;/span&gt;&lt;span&gt;(GenericMethod).Name, tParameters, tParameters.GetType().Name);
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; &lt;span&gt;22&lt;/span&gt;&lt;span&gt;         }
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; &lt;span&gt;23&lt;/span&gt;&lt;span&gt;     }
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt; &lt;span&gt;24&lt;/span&gt; }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;如代码所示，在声明泛型方法的时候没有指定具体的参数类型，等到需要调用的时候再指定，这就叫做延迟声明。泛型的设计思想（延迟思想，推迟一切可以推迟的）&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt;&lt;span&gt; 1&lt;/span&gt;  &lt;span&gt;1&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System;
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;  &lt;span&gt;2&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System.Collections.Generic;
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;  &lt;span&gt;3&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System.Linq;
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;  &lt;span&gt;4&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System.Text;
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;  &lt;span&gt;5&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System.Threading.Tasks;
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;  &lt;span&gt;6&lt;/span&gt; 
&lt;span&gt; 7&lt;/span&gt;  &lt;span&gt;7&lt;/span&gt; &lt;span&gt;namespace&lt;/span&gt;&lt;span&gt; _20171010Generic
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;  &lt;span&gt;8&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;  &lt;span&gt;9&lt;/span&gt;     &lt;span&gt;class&lt;/span&gt;&lt;span&gt; Program
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;10&lt;/span&gt;&lt;span&gt;     {
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; &lt;span&gt;11&lt;/span&gt;         &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Main(&lt;span&gt;string&lt;/span&gt;&lt;span&gt;[] args)
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;12&lt;/span&gt;&lt;span&gt;         {
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;13&lt;/span&gt; 
&lt;span&gt;14&lt;/span&gt; &lt;span&gt;14&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; iValue = &lt;span&gt;123&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;15&lt;/span&gt;             &lt;span&gt;string&lt;/span&gt; sValue = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;TestName&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;16&lt;/span&gt;             DateTime dtValue =&lt;span&gt; DateTime.Now;
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; &lt;span&gt;17&lt;/span&gt;             &lt;span&gt;object&lt;/span&gt; oValue = &lt;span&gt;new&lt;/span&gt; &lt;span&gt;object&lt;/span&gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt; &lt;span&gt;18&lt;/span&gt; 
&lt;span&gt;19&lt;/span&gt; &lt;span&gt;19&lt;/span&gt;&lt;span&gt;             GenericMethod.Show(iValue);
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;20&lt;/span&gt;&lt;span&gt;             GenericMethod.Show(sValue);
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;21&lt;/span&gt;&lt;span&gt;             GenericMethod.Show(oValue);
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; &lt;span&gt;22&lt;/span&gt;&lt;span&gt;             GenericMethod.Show(dtValue);
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; &lt;span&gt;23&lt;/span&gt;             Console.WriteLine(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;———————我是华丽的分割线————————&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt; &lt;span&gt;24&lt;/span&gt;             GenericMethod.Show&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt;(iValue);
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt; &lt;span&gt;25&lt;/span&gt;             GenericMethod.Show&amp;lt;&lt;span&gt;string&lt;/span&gt;&amp;gt;&lt;span&gt;(sValue);
&lt;/span&gt;&lt;span&gt;26&lt;/span&gt; &lt;span&gt;26&lt;/span&gt;             GenericMethod.Show&amp;lt;&lt;span&gt;object&lt;/span&gt;&amp;gt;&lt;span&gt;(oValue);
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt; &lt;span&gt;27&lt;/span&gt;             GenericMethod.Show&amp;lt;DateTime&amp;gt;&lt;span&gt;(dtValue);
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt; &lt;span&gt;28&lt;/span&gt;            
&lt;span&gt;29&lt;/span&gt; &lt;span&gt;29&lt;/span&gt;             Console.WriteLine(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;———————我是华丽的分割线————————&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;30&lt;/span&gt; &lt;span&gt;30&lt;/span&gt;             Console.WriteLine(&lt;span&gt;typeof&lt;/span&gt;(List&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt;));
&lt;/span&gt;&lt;span&gt;31&lt;/span&gt; &lt;span&gt;31&lt;/span&gt;             Console.WriteLine(&lt;span&gt;typeof&lt;/span&gt;(Dictionary&amp;lt;,&amp;gt;&lt;span&gt;));
&lt;/span&gt;&lt;span&gt;32&lt;/span&gt; &lt;span&gt;32&lt;/span&gt;             Console.WriteLine(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;———————我是华丽的分割线————————&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;33&lt;/span&gt; &lt;span&gt;33&lt;/span&gt;&lt;span&gt;         }
&lt;/span&gt;&lt;span&gt;34&lt;/span&gt; &lt;span&gt;34&lt;/span&gt;&lt;span&gt;     }
&lt;/span&gt;&lt;span&gt;35&lt;/span&gt; &lt;span&gt;35&lt;/span&gt; }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/951104/201710/951104-20171010182110230-1059713758.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt; 泛型方法的调用，第一种  GenericMethod.Show(iValue);调用方法不指定类型参数，在编译的时候编译器自动编译推算(语法糖)，第二种  GenericMethod.Show&amp;lt;int&amp;gt;(iValue);调用方法指定类型参数，类型参数和参数类型须一致，否则编译不通过。VS2017鼠标移上去会提示可以简化方法名称。编译的时候，类型参数编译为占位符，程序运行的时候，JIT(即时编译（Just In-Time compile）即时编译为真实类型。所以使用泛型性能会比使用object作为参数的方法好，(ps:经过测试)。 Console.WriteLine(typeof(List&amp;lt;int&amp;gt;)); 和Console.WriteLine(typeof(Dictionary&amp;lt;,&amp;gt;));的运行结果中有个~1,和~2就表示类型参数的占位符。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;　&lt;strong&gt;　3.0 泛型主要的四种：&lt;/strong&gt;泛型类，&lt;/span&gt; 泛型方法，&lt;strong&gt;泛型接口，&lt;/strong&gt;泛型委托&lt;span&gt;　　&lt;/span&gt;&lt;/p&gt;

&lt;div class=&quot;cnblogs_Highlighter&quot; readability=&quot;35&quot;&gt;
&lt;pre class=&quot;brush:csharp;gutter:true;&quot;&gt;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace _20171010Generic
{
    /// &amp;lt;summary&amp;gt;
    /// 动物类
    /// &amp;lt;/summary&amp;gt;
    public class AnimalModel
    {
        public int Id { get; set; }
        public String Name { get; set; }
        public virtual void Cry()
        { }
    }
    public interface IEat
    {
        void Eat();
    }
    public interface ISleep
    {
        void Sleep();
    }

    /// &amp;lt;summary&amp;gt;
    /// 狗类
    /// &amp;lt;/summary&amp;gt;
    public class Dog:AnimalModel
    {
        public override void Cry()
        {
            Console.WriteLine(&quot;旺旺旺。。。。。&quot;);
        }
    }
    /// &amp;lt;summary&amp;gt;
    /// 猫类
    /// &amp;lt;/summary&amp;gt;
    public class Cat : AnimalModel
    {
        public override void Cry()
        {
            Console.WriteLine(&quot;喵喵瞄。。。。。。。&quot;);
        }
    }

    /// &amp;lt;summary&amp;gt;
    /// 玫瑰花类
    /// &amp;lt;/summary&amp;gt;
    public class Rose
    {
        public int Id { get; set; }
        public string Name { get; set; }
    }

}
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt; 首先先新建了一个AnimalModel类，里面定义了一个动物类，动物类里有个虚方法Cry，一个狗类，狗类继承了动物类，一个猫类，重写了虚方法Cry。一个IEat接口和ISleep接口，&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;48&quot;&gt;
&lt;pre&gt;
&lt;span&gt;&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System;
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System.Collections.Generic;
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System.Linq;
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System.Text;
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System.Threading.Tasks;
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; 
&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;namespace&lt;/span&gt;&lt;span&gt; _20171010Generic
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;{
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt;&lt;span&gt; 泛型类
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt;12&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;typeparam name=&quot;T&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;类型参数&lt;/span&gt;&lt;span&gt;&amp;lt;/typeparam&amp;gt;&lt;/span&gt;
&lt;span&gt;13&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;typeparam name=&quot;S&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;类型参数&lt;/span&gt;&lt;span&gt;&amp;lt;/typeparam&amp;gt;&lt;/span&gt;
&lt;span&gt;14&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;typeparam name=&quot;K&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;类型参数&lt;/span&gt;&lt;span&gt;&amp;lt;/typeparam&amp;gt;&lt;/span&gt;
&lt;span&gt;15&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt; GenericClass&amp;lt;T, S, K&amp;gt;
&lt;span&gt;16&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;         &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span&gt;18&lt;/span&gt;         &lt;span&gt;///&lt;/span&gt;&lt;span&gt; 无返回值的泛型方法
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;         &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt;20&lt;/span&gt;         &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;typeparam name=&quot;T&quot;&amp;gt;&amp;lt;/typeparam&amp;gt;&lt;/span&gt;
&lt;span&gt;21&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; Show(T t)
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; &lt;span&gt;        {
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; 
&lt;span&gt;24&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;         &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span&gt;26&lt;/span&gt;         &lt;span&gt;///&lt;/span&gt;&lt;span&gt; 有返回值的泛型方法
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt;         &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt;28&lt;/span&gt;         &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;typeparam name=&quot;T&quot;&amp;gt;&amp;lt;/typeparam&amp;gt;&lt;/span&gt;
&lt;span&gt;29&lt;/span&gt;         &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
&lt;span&gt;30&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt;&lt;span&gt; T Get()
&lt;/span&gt;&lt;span&gt;31&lt;/span&gt; &lt;span&gt;        {
&lt;/span&gt;&lt;span&gt;32&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt; &lt;span&gt;default&lt;/span&gt;&lt;span&gt;(T);
&lt;/span&gt;&lt;span&gt;33&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;34&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;35&lt;/span&gt; 
&lt;span&gt;36&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span&gt;37&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt;&lt;span&gt; 泛型接口
&lt;/span&gt;&lt;span&gt;38&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt;39&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;typeparam name=&quot;W&quot;&amp;gt;&amp;lt;/typeparam&amp;gt;&lt;/span&gt;
&lt;span&gt;40&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;interface&lt;/span&gt; ISleep&amp;lt;W&amp;gt;
&lt;span&gt;41&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt;42&lt;/span&gt; &lt;span&gt;        W Sleep(W t);
&lt;/span&gt;&lt;span&gt;43&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;44&lt;/span&gt; 
&lt;span&gt;45&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span&gt;46&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt;&lt;span&gt; 有返回值的泛型委托
&lt;/span&gt;&lt;span&gt;47&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt;48&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;typeparam name=&quot;Y&quot;&amp;gt;&amp;lt;/typeparam&amp;gt;&lt;/span&gt;
&lt;span&gt;49&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
&lt;span&gt;50&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;delegate&lt;/span&gt; Y DlgYFun&amp;lt;Y&amp;gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt;51&lt;/span&gt; 
&lt;span&gt;52&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;delegate&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; DlgIntFun();
&lt;/span&gt;&lt;span&gt;53&lt;/span&gt; 
&lt;span&gt;54&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span&gt;55&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt;&lt;span&gt; 泛型类
&lt;/span&gt;&lt;span&gt;56&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt;57&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;typeparam name=&quot;W&quot;&amp;gt;&amp;lt;/typeparam&amp;gt;&lt;/span&gt;
&lt;span&gt;58&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;typeparam name=&quot;Y&quot;&amp;gt;&amp;lt;/typeparam&amp;gt;&lt;/span&gt;
&lt;span&gt;59&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;typeparam name=&quot;M&quot;&amp;gt;&amp;lt;/typeparam&amp;gt;&lt;/span&gt;
&lt;span&gt;60&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt; GenericChild&amp;lt;T, S, K&amp;gt;
&lt;span&gt;61&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt;: GenericClass&amp;lt;T, S, K&amp;gt;直接继承泛型类
&lt;/span&gt;&lt;span&gt;62&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt;: GenericClass&amp;lt;T, S, string&amp;gt;&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;类型参数可直接指定
&lt;/span&gt;&lt;span&gt;63&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt;: ISleep&amp;lt;string&amp;gt;&lt;/span&gt;
&lt;span&gt;64&lt;/span&gt;         : ISleep&amp;lt;T&amp;gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;实现泛型接口&lt;/span&gt;
&lt;span&gt;65&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt;66&lt;/span&gt;         T ISleep&amp;lt;T&amp;gt;&lt;span&gt;.Sleep(T t)
&lt;/span&gt;&lt;span&gt;67&lt;/span&gt; &lt;span&gt;        {
&lt;/span&gt;&lt;span&gt;68&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt; &lt;span&gt;default&lt;/span&gt;&lt;span&gt;(T);
&lt;/span&gt;&lt;span&gt;69&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;70&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;71&lt;/span&gt; 
&lt;span&gt;72&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span&gt;73&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt;&lt;span&gt; 普通类
&lt;/span&gt;&lt;span&gt;74&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt;75&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; Child
&lt;/span&gt;&lt;span&gt;76&lt;/span&gt;        &lt;span&gt;//&lt;/span&gt;&lt;span&gt; :GenericClass&amp;lt;T,S,K&amp;gt;错误的继承，普通类不能直接继承泛型类
&lt;/span&gt;&lt;span&gt;77&lt;/span&gt;        &lt;span&gt;//&lt;/span&gt;&lt;span&gt;: GenericClass&amp;lt;string, int, double&amp;gt;&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;必须指定全部确定的类型参数后可继承泛型
&lt;/span&gt;&lt;span&gt;78&lt;/span&gt;        &lt;span&gt;//&lt;/span&gt;&lt;span&gt;:ISleep&amp;lt;W&amp;gt;错误的实现泛型接口，普通类不能直接实现泛型接口，&lt;/span&gt;
&lt;span&gt;79&lt;/span&gt;        : ISleep&amp;lt;&lt;span&gt;string&lt;/span&gt;&amp;gt;
&lt;span&gt;80&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt;81&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; Sleep(&lt;span&gt;string&lt;/span&gt;&lt;span&gt; t)
&lt;/span&gt;&lt;span&gt;82&lt;/span&gt; &lt;span&gt;        {
&lt;/span&gt;&lt;span&gt;83&lt;/span&gt;             Console.WriteLine(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;实现了sleep泛型接口，返回参数是：{0}&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;, t);
&lt;/span&gt;&lt;span&gt;84&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt;&lt;span&gt; t;
&lt;/span&gt;&lt;span&gt;85&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;86&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;87&lt;/span&gt; }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;泛型类就在普通类名字后面加上&amp;lt;&amp;gt;和多个类型参数，需要注意的是 1.普通类不能直接继承泛型类和泛型接口，因为泛型的类型参数不确定，但是泛型类或泛型接口指定类型后可以继承泛型类或实现泛型接口，2.泛型类可以直接继承泛型类，也可以直接实现泛型接口,其子类的类型参数相当于声明了局部参数。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;　　4.0泛型的约束(基类约束，接口约束，引用类型约束，值类型约束，无参构造函数约束)&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;　　&lt;/strong&gt;　　回到上面写的那个GenericMethod类里的show方法，new 一个cat对象，Cat cat=new Cat(){ Id=1,Name=&quot;小黑猫&quot;}; 然后调用genericMentod.show(cat)方法。但是如果想要在show方法里访问Id,或者Name却不行。T是个不明确类型参数，所以无法访问，如图&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/951104/201710/951104-20171011141507715-1887885213.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;使用泛型约束解决方法：&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;46&quot;&gt;
&lt;pre&gt;
&lt;span&gt;&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System;
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System.Collections.Generic;
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System.Linq;
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System.Text;
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;using&lt;/span&gt;&lt;span&gt; System.Threading.Tasks;
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; 
&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;namespace&lt;/span&gt;&lt;span&gt; _20171010Generic
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;{
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt;&lt;span&gt; 泛型约束
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt;12&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; Constraint
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;        
&lt;span&gt;15&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Show&amp;lt;T&amp;gt;&lt;span&gt;(T tParameter)
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt;where T: AnimalModel  基类约束，就可以访问该类的方法或属性&lt;/span&gt;
&lt;span&gt;17&lt;/span&gt;             &lt;span&gt;where&lt;/span&gt; T:Cat &lt;span&gt;//&lt;/span&gt;&lt;span&gt;或者该子类       &lt;/span&gt;
&lt;span&gt;18&lt;/span&gt; &lt;span&gt;        {
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;             Console.WriteLine(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;泛型约束show方法--------id={0},name={1}&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;,tParameter.Id,tParameter.Name);
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; 
&lt;span&gt;22&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; Show(AnimalModel model)
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; &lt;span&gt;        {
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt;             Console.WriteLine(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;普通show方法--------id={0},name={1}&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;, model.Id, model.Name);
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;26&lt;/span&gt; 
&lt;span&gt;27&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; ShowInterface&amp;lt;T&amp;gt;&lt;span&gt;(T tParameter)
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt;            &lt;span&gt;//&lt;/span&gt;&lt;span&gt;where T: AnimalModel  基类约束，就可以访问该类的方法或属性&lt;/span&gt;
&lt;span&gt;29&lt;/span&gt;            &lt;span&gt;where&lt;/span&gt; T : Cat,ISleep,IEat&lt;span&gt;//&lt;/span&gt;&lt;span&gt;或者该子类约束，多个接口约束 &lt;/span&gt;
&lt;span&gt;30&lt;/span&gt;             
&lt;span&gt;31&lt;/span&gt; &lt;span&gt;        {
&lt;/span&gt;&lt;span&gt;32&lt;/span&gt;             Console.WriteLine(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;泛型约束ShowInterface方法--------id={0},name={1}&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;, tParameter.Id, tParameter.Name);
&lt;/span&gt;&lt;span&gt;33&lt;/span&gt;             tParameter.Sleep();&lt;span&gt;//&lt;/span&gt;&lt;span&gt;接口的方法&lt;/span&gt;
&lt;span&gt;34&lt;/span&gt; &lt;span&gt;            tParameter.Eat();
&lt;/span&gt;&lt;span&gt;35&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;36&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;37&lt;/span&gt; &lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;pre&gt;
&lt;span&gt;&lt;strong&gt;Constraint&lt;/strong&gt;类里的第一个&lt;strong&gt;show&lt;/strong&gt;方法中在后面带个 &lt;strong&gt;where关键字&lt;/strong&gt; 和&lt;strong&gt; 约束类型，&lt;/strong&gt;泛型方法里就能访问Id和Name,第二个&lt;strong&gt;show&lt;/strong&gt;方法是作为对比，虽然第二个方法也能实现同样的效果，但是相对泛型方法不灵活，泛型方法可以同时约束多个，比如第三个方法约束多个接口，和类，多个约束的关系是&amp;amp;&amp;amp;关系&lt;/span&gt;
&lt;/pre&gt;
&lt;pre&gt;
&lt;span&gt;泛型约束除了基类约束和接口约束几种，还有值类型约束，无参构造约束，引用类型约束等这几种。&lt;/span&gt;
&lt;/pre&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;&lt;span&gt;1&lt;/span&gt;  &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; T TestFun&amp;lt;T&amp;gt;&lt;span&gt;()
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; where T:class    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;引用类型约束
&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; where T:struct   &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;值类型约束&lt;/span&gt;
&lt;span&gt;4&lt;/span&gt;            &lt;span&gt;where&lt;/span&gt; T : &lt;span&gt;new&lt;/span&gt;()      &lt;span&gt;//&lt;/span&gt;&lt;span&gt;无参构造函数约束&lt;/span&gt;
&lt;span&gt;5&lt;/span&gt; &lt;span&gt;        {
&lt;/span&gt;&lt;span&gt;6&lt;/span&gt;            T t = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; T();
&lt;/span&gt;&lt;span&gt;7&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt; &lt;span&gt;default&lt;/span&gt;&lt;span&gt;(T);
&lt;/span&gt;&lt;span&gt;8&lt;/span&gt;         }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;   5.0协变和逆变&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;　out 协变(covariant) 修饰返回值，in 逆变(contravariant) 修饰传入参数。out和in只能放在接口或者泛型委托的的参数前面，类没有协变和逆变。&lt;/strong&gt;在.NET Framework里面，&lt;strong&gt;IEnumerable&amp;lt;T&amp;gt;&lt;/strong&gt;转到定义去看，其实就是个带out参数的泛型接口，&lt;strong&gt;Action&amp;lt;T&amp;gt;&lt;/strong&gt;转到定义去看就是个带in参数的泛型委托。还有一个逆变+协变的&lt;strong&gt;Func&amp;lt;T&amp;gt;&lt;/strong&gt;。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/951104/201710/951104-20171011170818184-374139711.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;img src=&quot;http://images2017.cnblogs.com/blog/951104/201710/951104-20171011171018949-620377652.png&quot; alt=&quot;&quot; width=&quot;1330&quot; height=&quot;408&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;像平常一样写代码：  AnimalModel animal = new AnimalModel();//实例化一个动物。&lt;/p&gt;
&lt;p&gt;　　　　　　             Dog dog = new Dog();//实例化一个条单身狗&lt;/p&gt;
&lt;p&gt;　　　　　　　　　&lt;strong&gt; AnimalModel dog2 = new Dog();//实例化一条单身狗（狗继承了动物父类，父类出现的地方都可以用子类代替，对的，狗一定是个动物）&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;　　　　　　　　　// Dog dog3 = new AnimalModel();动物不一定是条单身狗，程序编译不通过&lt;/p&gt;
&lt;p&gt;new一条单身狗没问题，new 一群单身狗试试看。&lt;/p&gt;
&lt;p&gt;　　　　　　　　List&amp;lt;Dog&amp;gt; dogList = new List&amp;lt;Dog&amp;gt;();//实例化一群单身狗（编译通过）&lt;/p&gt;
&lt;p&gt;　　　　　&lt;strong&gt;　　　List&amp;lt;AnimalModel&amp;gt; animalDog = new List&amp;lt;Dog&amp;gt;();//实例化一群单身狗（语法上不通过）&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;理论上来说第二种实例化一群狗的方式是没毛病的，一群狗也一定是一群动物，但是程序上是不通过是因为Listt&amp;lt;T&amp;gt;是个泛型　 &lt;strong&gt;List&amp;lt;Dog&amp;gt;不是继承&lt;/strong&gt;&lt;strong&gt;List&amp;lt;AnimalModel&amp;gt;，没有父子关系，程序只认关系。。。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;PS:写到这里我就快写不下去了，狗快被我自己玩坏了。&lt;/p&gt;
&lt;p&gt;要使上面那句代码编译通过，可以通过lambda表达式转化&lt;strong&gt; &lt;/strong&gt; &lt;strong&gt;List&amp;lt;&lt;/strong&gt;AnimalModel&amp;gt; animalDog = new List&amp;lt;Dog&amp;gt;().Select(x =&amp;gt; (&lt;strong&gt;&lt;strong&gt;AnimalModel&lt;/strong&gt;&lt;/strong&gt;)x).ToList();&lt;/p&gt;
&lt;p&gt;&lt;span&gt;使用IEnumerable：&lt;strong&gt;&lt;span&gt;IEnumerable&lt;/span&gt;&amp;lt;AnimalModel&amp;gt; animalDog= new List&amp;lt;Dog&amp;gt;();   //这就叫协变。&lt;/strong&gt;&lt;span&gt;IEnumerable&lt;/span&gt;&amp;lt;out  T&amp;gt;在编译的时候就通过转化了，我个人理解为out 是表示转化后的T返回标识。平常在工作中，有用过out 关键字作为标识的返回参数，会用，但是不其所以然。原理明白后自己也可以定义一个协变的泛型接口。&lt;/span&gt;&lt;/p&gt;

&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt;  &lt;span&gt;public&lt;/span&gt; &lt;span&gt;interface&lt;/span&gt; IMyTest&amp;lt;&lt;span&gt;out&lt;/span&gt; T&amp;gt;
&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; 
&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt; Test&amp;lt;T&amp;gt; : IMyTest&amp;lt;T&amp;gt;
&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; 
&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; 
&lt;span&gt;10&lt;/span&gt; 
&lt;span&gt;11&lt;/span&gt;    IMyTest&amp;lt;Animal&amp;gt; test3 = &lt;span&gt;new&lt;/span&gt; Test&amp;lt;Dog&amp;gt;();
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;逆变就和协变相反。逆变的in 的参数只能作为传入值，不能作为返回值。说白了，也是一种约束。协变和逆变的关键作用就是让编译器在运行时不报错。&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt;  &lt;span&gt;1&lt;/span&gt;  &lt;span&gt;public&lt;/span&gt; &lt;span&gt;interface&lt;/span&gt; IMyTest&amp;lt;inT&amp;gt;
&lt;span&gt; 2&lt;/span&gt;  &lt;span&gt;2&lt;/span&gt;&lt;span&gt;     {
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;  &lt;span&gt;3&lt;/span&gt; 
&lt;span&gt; 4&lt;/span&gt;  &lt;span&gt;4&lt;/span&gt;&lt;span&gt;     }
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;  &lt;span&gt;5&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt; Test&amp;lt;T&amp;gt; : IMyTest&amp;lt;T&amp;gt;
&lt;span&gt; 6&lt;/span&gt;  &lt;span&gt;6&lt;/span&gt;&lt;span&gt;     {
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;  &lt;span&gt;7&lt;/span&gt; 
&lt;span&gt; 8&lt;/span&gt;  &lt;span&gt;8&lt;/span&gt;&lt;span&gt;     }
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;  &lt;span&gt;9&lt;/span&gt; 
&lt;span&gt;10&lt;/span&gt; &lt;span&gt;10&lt;/span&gt; 
&lt;span&gt;11&lt;/span&gt; &lt;span&gt;11&lt;/span&gt;    IMyTest&amp;lt;Dog&amp;gt; test3 = &lt;span&gt;new&lt;/span&gt; Test&amp;lt;Animal&amp;gt;();
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;　&lt;/strong&gt;关于泛型的知识点还有很多，比如还有泛型的缓存，这个就有点难理解了。以上知识点是我平常通过各种途径学习总结的几点。如有不对欢迎指正。欢迎转载和分享，转载分享时请注明原创出处：&lt;a title=&quot;如此拉风的女人&quot; href=&quot;http://www.cnblogs.com/wwym/p/7646935.html&quot; target=&quot;_blank&quot;&gt;如此拉风的女人&lt;/a&gt;&lt;/p&gt;

</description>
<pubDate>Wed, 11 Oct 2017 15:08:00 +0000</pubDate>
<dc:creator>如此拉风的女人</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/wwym/p/7646935.html</dc:identifier>
</item>
</channel>
</rss>